(self.webpackChunkdataviz=self.webpackChunkdataviz||[]).push([[168,664],{7585:(e,t,n)=>{var r={"./arquero.js":2749,"./arrow.js":3487,"./dependencies.js":4505,"./dependency.js":5817,"./dom/canvas.js":6049,"./dom/context2d.js":9080,"./dom/download.js":9501,"./dom/element.js":7949,"./dom/index.js":9665,"./dom/input.js":6897,"./dom/range.js":1916,"./dom/select.js":5821,"./dom/svg.js":4591,"./dom/text.js":1738,"./dom/uid.js":1991,"./duckdb.js":9787,"./fileAttachment.js":535,"./files/buffer.js":3110,"./files/index.js":1798,"./files/text.js":6575,"./files/url.js":6079,"./generators/disposable.js":4899,"./generators/filter.js":2955,"./generators/index.js":3945,"./generators/input.js":5577,"./generators/map.js":9291,"./generators/observe.js":8649,"./generators/queue.js":3702,"./generators/range.js":5492,"./generators/valueAt.js":5489,"./generators/worker.js":451,"./html.js":33,"./index.js":1970,"./leaflet.js":6159,"./library.js":5345,"./md.js":7789,"./mermaid.js":3329,"./mutable.js":6628,"./now.js":2734,"./promises/delay.js":4382,"./promises/index.js":1065,"./promises/tick.js":9332,"./promises/when.js":573,"./require.js":5081,"./resolve.js":7374,"./sqlite.js":4396,"./svg.js":6820,"./table.js":9574,"./template.js":3322,"./tex.js":4239,"./that.js":6997,"./vegalite.js":1949,"./width.js":70,"./xlsx.js":5515};function a(e){return Promise.resolve().then((()=>{if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n(r[e])}))}a.keys=()=>Object.keys(r),a.id=7585,e.exports=a},2182:(e,t,n)=>{"use strict";n.d(t,{d:()=>c});var r=n(706),a=n(7569);console.log("files.ts");const s={},o=["A22H3JVLT3.csv","B2272MKLT3.csv","CAGRF12711.csv","CAGRF220610939.csv","CAGRF23110233-9.csv","CAGRF24010007.csv","CAGRF24010125.csv","CAGRF24010169-1.csv","CAGRF24020097.csv","CAGRF24020290.csv","CAGRF12711-4.csv","20240124_LH00406_0051_B22J25VLT3-CAGRF12711.csv","CAGRF23101260.csv","CAGRF23110233-10.csv","CAGRF24010125-new.csv"],i=r.d3.scaleOrdinal().range(["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]).domain(["fastq","fastq.gz","txt","hist.txt","json","json.gz","bam","mate2","mate1","pairsam","sam","vcf","gvcf","tmp","bed","junction","log","pac","fa","bin","out"]);function c(e){const t=e.datum();t.data||(console.log("Error, no data on this node, creating one",t),t.data={filesize:0,path:t.id,name:t.id.split("/").pop()||t.id,filetype:"folder",filestatus:"keep",timestamp:""});const n=e.append("details"),a=n.append("ul"),s=n.append("ul");n.attr("open",(()=>t.depth<2||null)).on("toggle",(function(e,n){r.d3.select(this).attr("drawn")||(r.d3.select(this).attr("drawn",!0),(t.children||[]).sort(((e,t)=>t.value-e.value)).forEach((e=>{void 0!==e.children||e&&e.data&&"folder"===e.data.filetype?c(a.append("li").datum(e)):function(e){const t=e.datum();e.classed("file",!0).html(`<span class="filename">${t.data.name}</span>\n    <span class="fileStatus">${y(t)}</span>\n    <span class="filesize">${l(t.value)}</span>`)}(s.append("li").datum(e))})))})),function(e){const t=e.datum();e.html(`<span class="foldername">${t.data.name}</span>\n    <span class="fileStatus">${y(t)}</span>\n    <span class="filesize">${l(t.value)}</span>`).classed("folder",!0).attr("id",`directory-${(0,r.Ce)(t.id)}`).on("mouseover",(function(e,n){e.stopPropagation(),r.d3.select(`#folder-${(0,r.Ce)(t.id)}`).classed("mouseover",!0)})).on("mouseout",(function(e,n){r.d3.select(`#folder-${(0,r.Ce)(t.id)}`).classed("mouseover",!1)}))}(n.append("summary").datum(t))}function l(e,t=!0,n=!0){return t?n&&e>1099511627776?`${r.d3.format(".2f")(e/1099511627776)} TiB`:e>1073741824?`${r.d3.format(".2f")(e/1073741824)} GiB`:e>1048576?`${r.d3.format(".2f")(e/1048576)} MiB`:`${r.d3.format(".2f")(e/1024)} KiB`:n&&e>1e12?`${r.d3.format(".2f")(e/1e12)} TB`:e>1e9?`${r.d3.format(".2f")(e/1e9)} GB`:e>1e6?`${r.d3.format(".2f")(e/1e6)} MB`:`${r.d3.format(".2f")(e/1e3)} KB`}function u(e,t){const n=["fastq.gz","bam","bai","vcf","vcf.gz","hist.txt","gvcf","gvcf.gz"],[a,s]=Object.values(e).reduce((([e,t],r)=>(e={name:"total",count:e.count+r.count,filesize:e.filesize+r.filesize},n.includes(r.name)||(t={name:"misc files (not including: "+n.join(", ")+")",count:t.count+r.count,filesize:t.filesize+r.filesize}),[e,t])),[{name:"total",count:0,filesize:0},{name:"misc files (not including: "+n.join(", ")+")",count:0,filesize:0}]);r.d3.select("#legend table tbody").selectAll("tr").data([a,s,...Object.values(e).sort(((e,t)=>t.filesize-e.filesize))],(e=>e.name)).enter().append("tr").html((e=>{let n=t(e.name);return("total"===e.name||e.name.includes("misc files"))&&(n="transparent"),`<td style="background-color:${n}"></td><td>${e.name}</td><td>${e.count}</td><td>${l(e.filesize)}</td>`}))}r.d3.select("#jsonButtons").selectAll("button").data(["CAGRF23101260.json","CAGRF23110233-10.json","CAGRF24010125.json"]).enter().append("button").attr("id",(e=>e.split(".")[0])).text((e=>e.split(".")[0])).on("click",(function(e,t){console.log("click",t),r.d3.json(`/AGRF/new/${t}`).then((e=>e.files.map((e=>d({filesize:e.Size||0,timestamp:e.LastModified,path:e.Key,name:e.Key.split("/").pop()||e.Key,filetype:e.Key.split(".").pop().toLowerCase(),filestatus:"keep"}))).filter((e=>null!==e)))).then(r.d3.stratify().path((e=>e.path))).then((e=>{console.log(e),e.sum((e=>e?e.filesize:0)),c(r.d3.select("#filestructure").datum(e));const n=new r.t1({title:t,element:"treemap",margin:10}).initTreemap({hierarchy:e,target:"filesize",color:i});u(s,n.color)}))})),r.d3.select("#buttons").selectAll("button").data(o).enter().append("button").attr("id",(e=>e.split(".")[0])).text((e=>e.split(".")[0])).on("click",(function(e,t){console.log("click",t),r.d3.text(`/AGRF/${t}`).then((e=>r.d3.csvParseRows(e).map((e=>{let[t,n,r,a,s,...o]=e;e.length<5&&([t,n,r,...o]=e);const i=o.join(),c=i.split("/"),l=c.pop()||c.pop();let u=l.split(".").pop();if("/"===i.slice(-1))u="folder";else if(-1!==["tar","gz","zip","txt","bai","out","err","log"].indexOf(u)){const e=l.split(".");e.length>2&&(u=e.slice(-2).join("."))}return d({filesize:parseInt(t),rsync:n,timestamp:r,path:i,name:l,filetype:u,filestatus:null})})))).then(r.d3.stratify().path((e=>e.path))).then((e=>{e.sum((e=>e.filesize)),c(r.d3.select("#filestructure").datum(e));const n=new r.t1({title:t,element:"treemap",margin:10}).initTreemap({hierarchy:e,target:"filesize",color:i});u(s,n.color)}))}));const f=window.location.hash;function d(e){const t=s[e.filetype]=s[e.filetype]||{name:e.filetype,list:[],count:0,filesize:0};return t.count+=1,t.filesize+=e.filesize,t.list.push(e),e}o.map((e=>e.split(".")[0])).indexOf(f)&&a(f).trigger("click"),"#aws"===f&&(console.log("#aws selected, trying to process aws.tsv"),r.d3.json("/AGRF/aws.json").then((e=>e.Contents.map((e=>{const t={filesize:e.Size,timestamp:e.LastModified,path:e.Key,name:e.Key.split("/").pop(),filetype:e.Key.split(".").pop().toLowerCase(),filestatus:"keep"};return d(t),t})))).then(r.d3.stratify().path((e=>e.path))).then((e=>{e.each((e=>{e.data||(e.data={timestamp:"",path:e.id,name:e.id.split("/").pop()||e.id,filetype:"folder",filestatus:"keep",filesize:0})})).sum((e=>e.filesize)),e.sum((e=>e?e.filesize:0)),c(r.d3.select("#filestructure").datum(e)),u(s,r.d3.scaleOrdinal(r.d3.schemeCategory10))}))),"#rsync"===f&&(console.log("#rsync selected, trying to process 20240709_LH00620_0027_A22KVHVLT3.csv"),r.d3.text("/AGRF/20240709_LH00620_0027_A22KVHVLT3.csv").then((e=>r.d3.csvParseRows(e).map((e=>{const[t,n,r,a,s,...o]=e,i=o.join(),c=i.split("/"),l=c.pop()||c.pop();let u=l.split(".").pop();if("/"===i.slice(-1))u="folder";else if(-1!==["tar","gz","zip","txt","bai","out","err","log"].indexOf(u)){const e=l.split(".");e.length>2&&(u=e.slice(-2).join("."))}return d({filesize:parseInt(t),rsync:n,timestamp:r,path:i,name:l,filetype:u,filestatus:null})})))).then(r.d3.stratify().path((e=>e.path))).then((e=>{console.log("Here is the hierarchy",e),console.log("There are this many filetypes:",Object.entries(s).length),console.log("Filetypes",s),e.sum((e=>e?e.filesize:0)),c(r.d3.select("#filestructure").datum(e)),new r.t1({element:"treemap",margin:10}).initTreemap({hierarchy:e,target:"filesize",color:i}),u(s,r.d3.scaleOrdinal(r.d3.schemeCategory10))})));var p={},h=["node_modules","bower_components","AppData","Media/Games","Cache","Frameworks","Contents","/lib/","plugins/",".lrdata/","/.git/","/.metadata/","/common/","/.retroarch/","/iPhoto Library/Masters/","/.meteor/","/src/","/iPhoto Library/Database","/."];h.forEach((e=>{p[e]={name:e,total_filesize:0,files:[]}})),"#pi4"===f&&(console.log("#pi4 selected, trying to process pi4_audit.txt"),r.d3.text("/AGRF/pi4_audit.txt").then((e=>r.d3.csvParseRows(e).map((([e,t,n,r])=>{const a={filesize:parseInt(e),rsync:t,timestamp:n,path:r,name:r.split("/").pop(),filetype:r.split(".").pop().toLowerCase(),filestatus:"keep"},s=h.find((e=>-1!==r.indexOf(e)));return s?(p[s].total_filesize+=a.filesize,p[s].files.push(a),null):a})).filter((e=>null!==e)))).then(r.d3.stratify().path((e=>e.path))).then((e=>{console.log("Here is the hierarchy",e),console.log("Filetypes",s),e.sum((e=>e?e.filesize:0)),r.d3.select("#filestructure"),new r.t1({element:"treemap",margin:10}).initTreemap({hierarchy:e,target:"filesize",color:i})}))),"#home"===f&&(console.log("#home selected, trying to process file_audit_full.csv"),r.d3.text("/AGRF/file_audit_full.csv").then((e=>r.d3.csvParseRows(e).map((e=>{const[t,n,...r]=e,a=parseInt(t),s=r.join(),o=s.split("/"),i=o.pop()||o.pop();let c="unknown";return"/"===s.slice(-1)?c="folder":-1!==i.indexOf(".")&&(c=i.split(".").pop().toLowerCase()),o.length>8||s.length>512||"folder"!==c&&a<52428800||-1!==s.indexOf("node_modules")||-1!==s.indexOf("bower_components")||-1!==s.indexOf("/.")||-1!==s.indexOf("AppData")||-1!==s.indexOf("Media/Games")||-1!==s.indexOf("Cache")||-1!==s.indexOf("Frameworks")||-1!==s.indexOf("Contents")||-1!==s.indexOf("/lib/")||-1!==s.indexOf("plugins/")||-1!==s.indexOf(".lrdata/")||-1!==s.indexOf("/.git/")||-1!==s.indexOf("/.metadata/")||-1!==s.indexOf("/common/")||-1!==s.indexOf("/.retroarch/")||-1!==s.indexOf("/iPhoto Library/Masters/")||-1!==s.indexOf("/.meteor/")||-1!==s.indexOf("/src/")||-1!==s.indexOf("/iPhoto Library/Database")?null:d({filesize:a,timestamp:n,path:s,name:i,filetype:c,filestatus:"keep"})})).filter((e=>null!==e)))).then(r.d3.stratify().path((e=>e.path))).then((e=>{console.log("Here is the hierarchy",e),console.log("There are this many filetypes:",Object.entries(s).length),console.log("Filetypes",s),e.sum((e=>e?e.filesize:0)),c(r.d3.select("#filestructure").datum(e)),new r.t1({element:"treemap",margin:10}).initTreemap({hierarchy:e,target:"filesize",color:i}),u(s,r.d3.scaleOrdinal(r.d3.schemeCategory10))})));const m={secondary_analysis:[/^secondary_analysis\/Results.*/,/^secondary_analysis\/Intermediate.*/,/^secondary_analysis\/commands.*.txt$/,/^secondary_analysis\/parameters.*.txt$/]};function y(e){return e.data?{keep:'<span class="status green">Keep</span>',delete:'<span class="status red">Ignore</span>',mixed:'<span class="status yellow">Mixed</span>'}[e.data.filestatus||b(e)]:(console.log("Error, no data on this node",e),"")}function b(e){const t=e.data;if(!t.filestatus)if("folder"===t.filetype&&e.children){const n=e.children.map((e=>b(e))),r=[...new Set(n)];0===n.length?t.filestatus="delete":1===r.length?t.filestatus=r[0]:t.filestatus="mixed"}else t.filestatus="keep",Object.entries(m).forEach((([e,n])=>{t.path.includes(e)&&(n.find((e=>e.test(t.path)))||(t.filestatus="delete"))}));return t.filestatus}},2654:(e,t,n)=>{"use strict";var r=n(706),a=n(2182);function s(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let a of e)(a=+t(a,++r,e))&&(n+=a)}return n}function o(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function i(e){return e.depth}function c(e,t){return e.sourceLinks.length?e.depth:t-1}function l(e){return function(){return e}}function u(e,t){return d(e.source,t.source)||e.index-t.index}function f(e,t){return d(e.target,t.target)||e.index-t.index}function d(e,t){return e.y0-t.y0}function p(e){return e.value}function h(e){return e.index}function m(e){return e.nodes}function y(e){return e.links}function b(e,t){const n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function g({nodes:e}){for(const t of e){let e=t.y0,n=e;for(const n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(const e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}var w=Math.PI,v=2*w,_=1e-6,x=v-_;function A(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function k(){return new A}A.prototype=k.prototype={constructor:A,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,a,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+s)},arcTo:function(e,t,n,r,a){e=+e,t=+t,n=+n,r=+r,a=+a;var s=this._x1,o=this._y1,i=n-e,c=r-t,l=s-e,u=o-t,f=l*l+u*u;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>_)if(Math.abs(u*i-c*l)>_&&a){var d=n-s,p=r-o,h=i*i+c*c,m=d*d+p*p,y=Math.sqrt(h),b=Math.sqrt(f),g=a*Math.tan((w-Math.acos((h+f-m)/(2*y*b)))/2),v=g/b,x=g/y;Math.abs(v-1)>_&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+a+","+a+",0,0,"+ +(u*d>l*p)+","+(this._x1=e+x*i)+","+(this._y1=t+x*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,r,a,s){e=+e,t=+t,s=!!s;var o=(n=+n)*Math.cos(r),i=n*Math.sin(r),c=e+o,l=t+i,u=1^s,f=s?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>_||Math.abs(this._y1-l)>_)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%v+v),f>x?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-i)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>_&&(this._+="A"+n+","+n+",0,"+ +(f>=w)+","+u+","+(this._x1=e+n*Math.cos(a))+","+(this._y1=t+n*Math.sin(a))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const j=k;var $=Array.prototype.slice;function E(e){return function(){return e}}function T(e){return e[0]}function L(e){return e[1]}function O(e){return e.source}function F(e){return e.target}function q(e,t,n,r,a){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,a,r,a)}function C(e){return[e.source.x1,e.y0]}function D(e){return[e.target.x0,e.y1]}function N(){return function(e){var t=O,n=F,r=T,a=L,s=null;function o(){var o,i=$.call(arguments),c=t.apply(this,i),l=n.apply(this,i);if(s||(s=o=j()),e(s,+r.apply(this,(i[0]=c,i)),+a.apply(this,i),+r.apply(this,(i[0]=l,i)),+a.apply(this,i)),o)return s=null,o+""||null}return o.source=function(e){return arguments.length?(t=e,o):t},o.target=function(e){return arguments.length?(n=e,o):n},o.x=function(e){return arguments.length?(r="function"==typeof e?e:E(+e),o):r},o.y=function(e){return arguments.length?(a="function"==typeof e?e:E(+e),o):a},o.context=function(e){return arguments.length?(s=null==e?null:e,o):s},o}(q).source(C).target(D)}var M=n(1970),R=n(7569);console.log("Hello world");const S={},I=r.d3.scaleOrdinal().range(["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]).domain(["fastq","fastq.gz","txt","hist.txt","json","json.gz","bam","mate2","mate1","pairsam","sam","vcf","gvcf","tmp","bed","junction","log","pac","fa","bin","out"]),P={},z=["6166","6167","8251","9263","9613","9669","9811","9884","10019","10050","10067","10149","10245","10331","10491","12198","12323","12783","12953","12954","13355","14597","15768","15769","17690","19335","19342","19452","19671","19897"],B={};function U(e,t){e.forEach((e=>{e.summary&&(e.total_file_count=parseInt(e.summary.total.file_count),e.total_file_size_bytes=parseInt(e.summary.total.file_size_bytes),e.total_file_size_display=e.summary.total.file_size_human)})),(0,r.ss)(e,{element:t,titles:["contract_pk","run_id","total_file_size","total_file_count","secondary_analysis_analyst","first_approver","contract_folder_path","contract_sent"],customData:{total_file_size:{sort:"total_file_size_bytes",display:"total_file_size_display"}},customRenderers:{contract_pk:(e,t,n,r)=>`<a href="http://bioweb02.agrf.org.au/nextgenpipeline/admin/nextgenruns/contract/${n.contract_pk.split(".")[0]}/change/" target="_blank">${n.contract_pk}</a>`,run_id:(e,t,n,r)=>{var a=H(n.contract_folder_path);return`<a href="#${e}" onclick="click_me('${a.flowcell}_${a.contract_id}')">${e}</a>`}}})}function G({data:e,sankeyData:t,filter:n,uniqueKeyFunction:r,names:a}){let s,o;if(n)s=e.filter(n),o=e.filter((e=>!n(e)));else{if(!r)throw new Error("Must provide either filter or uniqueKeyFunction");s=function(e,t){const n=new Map;for(const r of e){const e=t(r);n.has(e)?n.get(e).push(r):n.set(e,[r])}return Array.from(n.values()).filter((e=>1==e.length)).flat()}(e,r),o=function(e,t){const n=new Map;for(const r of e){const e=t(r);n.has(e)?n.get(e).push(r):n.set(e,[r])}return Array.from(n.values()).filter((e=>e.length>1)).flat()}(e,r)}return t.nodes.find((e=>e.name===a.original))||t.nodes.push({name:a.original,category:"Start"}),t.nodes.push({name:a.positive,category:"Good"}),t.nodes.push({name:a.negative,category:"Reject"}),t.links.push({source:a.original,target:a.positive,value:s.length}),t.links.push({source:a.original,target:a.negative,value:o.length}),U(s,`table#${a.positiveID}`),U(o,`table#${a.negativeID}`),s}function W({data:e,log_id:t,element_id:n,legend_id:s}){if(0===e.files.length)return;if(e.files.length>1e4)return;r.d3.select(n).html("").append("div").attr("id",`treemap-${t}`);const o=e.contract_dir.split("/").pop(),i=e.contract_dir,c=e.files.filter((e=>"included_folder"!==e[4])).map((e=>({path:`${o}${e[1].replace(i,"")}/${e[0]}`,name:`${o}${e[1].replace(i,"")}/${e[0]}`,filename:e[0],directory:e[1],filesize:e[2],filetype:K(e[0]),date_modified:e[3],status:e[4],level:e[5]}))),l=r.d3.stratify().path((e=>e.path))(c);if(l.sum((e=>e&&e.filesize||0)),console.log(l),new r.t1({element:`treemap-${t}`,margin:5,width:500,height:1e3,nav:!1}).initTreemap({hierarchy:l,target:"filesize",color:I}),s){const e=r.d3.select(s).datum(l);(0,a.d)(e)}}function H(e){const t=e.match(/\/data\/Analysis\/(.*)\/(.*_.(.*))\/contracts(?:_\d+)?\/([^_]*)(?:_.*)?/);if(!t)return console.error("No match for folder",e),null;const[n,r,a,s,o]=t;return{instrument:r,run:a,flowcell:s,contract_id:o}}function K(e){if(!e)throw new Error("No filename provided");let t="unknown",n=e.split(".");return n.length>1&&(t=n.pop()),["tar","gz","zip","txt","bai","out","err","log"].includes(t)&&n.length>1&&(t=n.pop()+"."+t),t}globalThis.click_me=function(e){toggleSlider("open"),r.d3.select("#slideOutFooter div.content").html(""),function(e){const t=r.d3.select("#slideOutFooter div.content");r.d3.json(`/AGRF/clinical/${e}.json`).then((function(n){t.append("h2").text(e);const r=t.append("div").classed("row",!0);r.append("div").classed("col-xs-6",!0).attr("id",`footer-treemap-${e}`),r.append("div").classed("col-xs-6",!0).classed("filestructure",!0).attr("id",`footer-legend-${e}`),W({data:n,log_id:e,element_id:`#slideOutFooter div.content div#footer-treemap-${e}`,legend_id:`#slideOutFooter div.content div#footer-legend-${e}`})}))}(e)},r.d3.json("/clinical").then((function(e){return Promise.all([r.d3.csv("/AGRF/contract_list_for_purging_is_clinical_2024_08_28.csv"),...e.map((e=>r.d3.json(`/AGRF/clinical_5/${e}`).catch((t=>(console.error(t),console.error(e),null)))))]).then((function([e,...t]){return[e,t.sort(((e,t)=>e.summary.total.file_size_bytes<t.summary.total.file_size_bytes?-1:1))]})).then((function([e,t]){const n=e.map((e=>{const n=t.find((t=>t.contract_dir===e.contract_folder_path));return n?Object.assign(e,n):(console.info("No clinical data for",e.contract_folder_path),e)})),a={nodes:[],links:[]};U(e,"table#PurgeList");const w=G({data:e,sankeyData:a,uniqueKeyFunction:e=>e.contract_folder_path,names:{original:'"Clinical" Bioweb cases',positive:"Unique Folder",positiveID:"UniqueFolders",negative:"Duplicate Folder",negativeID:"DuplicateFolders"}}),v=G({data:w,sankeyData:a,uniqueKeyFunction:e=>e.contract_pk,names:{original:"Unique Folder",positive:"Unique contract_pk",positiveID:"UniquePK",negative:"Duplicate contract_pk",negativeID:"DuplicatePK"}}).map((e=>{const n=t.find((t=>t.contract_dir===e.contract_folder_path));return{...e,...n}})).filter((e=>!1===z.includes(e.contract_pk))),_=G({data:v,sankeyData:a,filter:e=>e.summary.total.file_size_bytes>2e8,names:{original:"Unique contract_pk",positive:"More than 200 mb total folder size",positiveID:"MoreThan200mb",negative:"Less than 200 mb total folder size",negativeID:"LessThan200mb"}}),x=G({data:_,sankeyData:a,filter:e=>e.summary.total.file_count<1e3,names:{original:"More than 200 mb total folder size",positive:"Less than 1000 files",positiveID:"LessThan1000Files",negative:"More than 1000 files",negativeID:"MoreThan1000Files"}}),A=G({data:x,sankeyData:a,filter:e=>0==e.summary.exclude.file_count,names:{original:"Less than 1000 files",positive:"Clean Project Folder",positiveID:"CleanProject",negative:"Dirty Project Folder",negativeID:"DirtyProject"}});Promise.all(A.map((e=>{const t=H(e.contract_folder_path);return r.d3.json(`/AGRF/clinical/${t.flowcell}_${t.contract_id}.json`)}))).then((e=>A.map((t=>{const n=e.find((e=>e.contract_dir===t.contract_folder_path));return n?Object.assign(t,n):(console.info("No full clinical data for",t.contract_folder_path),t)})))).then((t=>{const n=G({data:t,sankeyData:a,filter:e=>0==e.files.filter((e=>e[0].endsWith(".bam"))).length,names:{original:"Clean Project Folder",positive:"No BAM files",positiveID:"NoBams",negative:"BAM files present",negativeID:"ContainsBams"}});a.nodes.push({name:"Upload Phase 1",category:"End"}),a.links.push({source:"No BAM files",target:"Upload Phase 1",value:n.length}),a.nodes.push({name:"Upload Phase 2",category:"End"}),a.links.push({source:"BAM files present",target:"Upload Phase 2",value:t.length-n.length}),a.nodes.push({name:"Upload Phase 3",category:"End"}),a.links.push({source:"Dirty Project Folder",target:"Upload Phase 3",value:x.length-A.length}),a.links.push({source:"More than 1000 files",target:"Upload Phase 3",value:_.length-x.length}),a.links.push({source:"Less than 200 mb total folder size",target:"Upload Phase 3",value:v.length-_.length}),a.nodes.push({name:"Upload Phase 4",category:"End"}),a.links.push({source:"Duplicate contract_pk",target:"Upload Phase 4",value:w.length-v.length}),a.links.push({source:"Duplicate Folder",target:"Upload Phase 4",value:e.length-w.length}),function(e){const t=1500,n=r.d3.format(",.0f"),a=r.d3.select("#sankey").append("svg").attr("viewBox",[0,0,t,400]),w=function(){let e,t,n,r=0,a=0,i=1,w=1,v=24,_=8,x=h,A=c,k=m,j=y,$=6;function E(){const c={nodes:k.apply(null,arguments),links:j.apply(null,arguments)};return function({nodes:e,links:t}){for(const[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];const r=new Map(e.map(((t,n)=>[x(t,n,e),t])));for(const[e,n]of t.entries()){n.index=e;let{source:t,target:a}=n;"object"!=typeof t&&(t=n.source=b(r,t)),"object"!=typeof a&&(a=n.target=b(r,a)),t.sourceLinks.push(n),a.targetLinks.push(n)}if(null!=n)for(const{sourceLinks:t,targetLinks:r}of e)t.sort(n),r.sort(n)}(c),function({nodes:e}){for(const t of e)t.value=void 0===t.fixedValue?Math.max(s(t.sourceLinks,p),s(t.targetLinks,p)):t.fixedValue}(c),function({nodes:e}){const t=e.length;let n=new Set(e),r=new Set,a=0;for(;n.size;){for(const e of n){e.depth=a;for(const{target:t}of e.sourceLinks)r.add(t)}if(++a>t)throw new Error("circular link");n=r,r=new Set}}(c),function({nodes:e}){const t=e.length;let n=new Set(e),r=new Set,a=0;for(;n.size;){for(const e of n){e.height=a;for(const{source:t}of e.targetLinks)r.add(t)}if(++a>t)throw new Error("circular link");n=r,r=new Set}}(c),function(n){const c=function({nodes:e}){const n=o(e,(e=>e.depth))+1,a=(i-r-v)/(n-1),s=new Array(n);for(const t of e){const e=Math.max(0,Math.min(n-1,Math.floor(A.call(null,t,n))));t.layer=e,t.x0=r+e*a,t.x1=t.x0+v,s[e]?s[e].push(t):s[e]=[t]}if(t)for(const e of s)e.sort(t);return s}(n);e=Math.min(_,(w-a)/(o(c,(e=>e.length))-1)),function(t){const n=function(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}(t,(t=>(w-a-(t.length-1)*e)/s(t,p)));for(const r of t){let t=a;for(const a of r){a.y0=t,a.y1=t+a.value*n,t=a.y1+e;for(const e of a.sourceLinks)e.width=e.value*n}t=(w-t+e)/(r.length+1);for(let e=0;e<r.length;++e){const n=r[e];n.y0+=t*(e+1),n.y1+=t*(e+1)}D(r)}}(c);for(let e=0;e<$;++e){const t=Math.pow(.99,e),n=Math.max(1-t,(e+1)/$);L(c,t,n),T(c,t,n)}}(c),g(c),c}function T(e,n,r){for(let a=1,s=e.length;a<s;++a){const s=e[a];for(const e of s){let t=0,r=0;for(const{source:n,value:a}of e.targetLinks){let s=a*(e.layer-n.layer);t+=N(n,e)*s,r+=s}if(!(r>0))continue;let a=(t/r-e.y0)*n;e.y0+=a,e.y1+=a,C(e)}void 0===t&&s.sort(d),O(s,r)}}function L(e,n,r){for(let a=e.length-2;a>=0;--a){const s=e[a];for(const e of s){let t=0,r=0;for(const{target:n,value:a}of e.sourceLinks){let s=a*(n.layer-e.layer);t+=M(e,n)*s,r+=s}if(!(r>0))continue;let a=(t/r-e.y0)*n;e.y0+=a,e.y1+=a,C(e)}void 0===t&&s.sort(d),O(s,r)}}function O(t,n){const r=t.length>>1,s=t[r];q(t,s.y0-e,r-1,n),F(t,s.y1+e,r+1,n),q(t,w,t.length-1,n),F(t,a,0,n)}function F(t,n,r,a){for(;r<t.length;++r){const s=t[r],o=(n-s.y0)*a;o>1e-6&&(s.y0+=o,s.y1+=o),n=s.y1+e}}function q(t,n,r,a){for(;r>=0;--r){const s=t[r],o=(s.y1-n)*a;o>1e-6&&(s.y0-=o,s.y1-=o),n=s.y0-e}}function C({sourceLinks:e,targetLinks:t}){if(void 0===n){for(const{source:{sourceLinks:e}}of t)e.sort(f);for(const{target:{targetLinks:t}}of e)t.sort(u)}}function D(e){if(void 0===n)for(const{sourceLinks:t,targetLinks:n}of e)t.sort(f),n.sort(u)}function N(t,n){let r=t.y0-(t.sourceLinks.length-1)*e/2;for(const{target:a,width:s}of t.sourceLinks){if(a===n)break;r+=s+e}for(const{source:e,width:a}of n.targetLinks){if(e===t)break;r-=a}return r}function M(t,n){let r=n.y0-(n.targetLinks.length-1)*e/2;for(const{source:a,width:s}of n.targetLinks){if(a===t)break;r+=s+e}for(const{target:e,width:a}of t.sourceLinks){if(e===n)break;r-=a}return r}return E.update=function(e){return g(e),e},E.nodeId=function(e){return arguments.length?(x="function"==typeof e?e:l(e),E):x},E.nodeAlign=function(e){return arguments.length?(A="function"==typeof e?e:l(e),E):A},E.nodeSort=function(e){return arguments.length?(t=e,E):t},E.nodeWidth=function(e){return arguments.length?(v=+e,E):v},E.nodePadding=function(t){return arguments.length?(_=e=+t,E):_},E.nodes=function(e){return arguments.length?(k="function"==typeof e?e:l(e),E):k},E.links=function(e){return arguments.length?(j="function"==typeof e?e:l(e),E):j},E.linkSort=function(e){return arguments.length?(n=e,E):n},E.size=function(e){return arguments.length?(r=a=0,i=+e[0],w=+e[1],E):[i-r,w-a]},E.extent=function(e){return arguments.length?(r=+e[0][0],i=+e[1][0],a=+e[0][1],w=+e[1][1],E):[[r,a],[i,w]]},E.iterations=function(e){return arguments.length?($=+e,E):$},E}().nodeId((e=>e.name)).nodeAlign(i).nodeWidth(15).nodePadding(10).extent([[1,5],[1499,395]]),{nodes:v,links:_}=w({nodes:e.nodes.map((e=>Object.assign({},e))),links:e.links.map((e=>Object.assign({},e)))}),x=r.d3.scaleOrdinal(r.d3.schemeCategory10).domain(["Start","End","Good","Reject"]);a.append("g").attr("stroke","#000").selectAll().data(v).join("rect").attr("x",(e=>e.x0)).attr("y",(e=>e.y0)).attr("height",(e=>e.y1-e.y0)).attr("width",(e=>e.x1-e.x0)).attr("fill",(e=>x(e.category))).append("title").text((e=>`${e.name}\n${n(e.value)} TWh`));const A=a.append("g").attr("fill","none").attr("stroke-opacity",.5).selectAll().data(_).join("g").style("mix-blend-mode","multiply");{const e=A.append("linearGradient").attr("id",(e=>(e.uid=V.uid("link")).id)).attr("gradientUnits","userSpaceOnUse").attr("x1",(e=>e.source.x1)).attr("x2",(e=>e.target.x0));e.append("stop").attr("offset","0%").attr("stop-color",(e=>x(e.source.category))),e.append("stop").attr("offset","100%").attr("stop-color",(e=>x(e.target.category)))}A.append("path").attr("d",N()).attr("stroke",(e=>e.uid)).attr("stroke-width",(e=>Math.max(1,e.width))),A.append("title").text((e=>`${e.source.name} → ${e.target.name}\n${n(e.value)} TWh`)),a.append("g").selectAll().data(v).join("text").attr("x",(e=>e.x0<750?e.x1+6:e.x0-6)).attr("y",(e=>(e.y1+e.y0)/2)).attr("dy","0.35em").attr("text-anchor",(e=>e.x0<750?"start":"end")).text((e=>`${e.name} (${n(e.value)})`)),a.node()}(a)}));const k=r.d3.select("table#clinical"),j=["contract_pk","Log ID","Total File Size","Total File Count","Analyst","First Approver","Contract Folder Path","Date Sent","Command"];return k.select("thead").append("tr").selectAll("th").data(j).enter().append("th").html((function(e){return e})),k.select("tbody").selectAll("tr").data(t).enter().append("tr").each((function(t,a){const{instrument:s,run:o,flowcell:i,contract_id:c}=H(t.contract_dir),l=e.find((e=>e.contract_folder_path===t.contract_dir));if(!l)return void console.error("No excel data for",t.contract_dir);n.push({...t,...l});const u=l.contract_pk.split(".")[0];if(z.includes(u))return void r.d3.select(this).remove();const f=`${i}_${c}`;r.d3.select(this).attr("id",`clinical_row2-${f}`).classed("hidden",!0);var d=k.select("tbody").insert("tr",`#clinical_row2-${f}`).attr("id",`clinical_row-${f}`);d.append("td").append("a").attr("href",`http://bioweb02.agrf.org.au/nextgenpipeline/admin/nextgenruns/contract/${u}/change/`).attr("target","_blank").text(u);var p=d.append("td").classed("log_id_td",!0).style("text-wrap","nowrap");p.append("a").attr("href","#x").on("click",(function(){!function(e){r.d3.json(`/AGRF/clinical/${e}.json`).then((t=>{if(r.d3.select(`#clinical_row2-${e} svg`).node())return;if(0===t.files.length||t.files.length>1e4)return void r.d3.select(`#clinical_row2-${e}`).append("td").attr("colspan",j.length).text(`Too many files to display: ${t.files.length}`);r.d3.select(`#clinical_row2-${e}`).append("td").attr("colspan",4).append("div").classed("followScroll",!0),W({data:t,log_id:e,element_id:`#clinical_row2-${e} td div`,legend_id:null});const n=r.d3.select(`#clinical_row2-${e}`).append("td").attr("colspan",j.length-4).append("table");n.append("thead").append("tr").selectAll("th").data(["Type","Filepath","Size","Status","Level"]).enter().append("th").text((e=>e)),n.append("tbody").selectAll("tr").data(t.files.filter((e=>"included_folder"!==e[4]))).enter().append("tr").html((e=>{const t=[e[1].split(c).pop(),e[0]].join("/").slice(1),n=K(e[0]),r=function(e){let t=0;for(;e>=1024;)e/=1024,t++;return`${e.toFixed(2)} ${["B","KB","MB","GB","TB","PB"][t]}`}(parseInt(e[2]));return`<td style="color: black; background:${I(n)}">${n}</td><td>${t}</td><td>${r}</td><td>${e[4]}</td><td>${e[5]}</td>`}))}))}(f),R(`#clinical_row2-${f}`).toggleClass("hidden")})).text(f),p.append("p").text(f),d.append("td").text(t.summary.include.file_size_human),d.append("td").text(t.summary.total.file_count),d.append("td").text(l.secondary_analysis_analyst),d.append("td").text(l.first_approver),d.append("td").text(l.contract_folder_path).datum(t).classed("red",(e=>l.contract_folder_path!==e.contract_dir)),d.append("td").style("white-space","nowrap").text(l.contract_sent),d.append("td").style("white-space","nowrap").append("code").text(`cloudian_cache_workaround.sh ${t.contract_dir.split("/data/Analysis/")[1]} clinical ${l.contract_sent}`)})),n}))})).then((function(e){console.log("clinical data",e);const t=(0,r.ss)(e,{element:"table#DataTable"});console.log("Datatables Output",t),e.forEach((e=>{}))})),Promise.all([r.d3.csv("/AGRF/mysql_reference_contracts_2024-08-19.csv").then((e=>(e.forEach((e=>{B[function(e){const t=e.Run,n=e["Contract Id"];return`${t.split("_").pop().slice(1)}_${n}`}(e)]=e})),B))),r.d3.dsv("|","/AGRF/slurm_logs_2024_08_19.csv").then((function(e){return e.forEach((function(e){const t=e.JobID.split(".")[0]||e.JobID;t in S?S[t].push(e):S[t]=[e]})),S})).then((function(e){return Object.entries(e).forEach((function([e,t]){const n=function(e){const t=e.map((e=>e.JobName)),n=[/s3_archive_using_temp_folder-(.*)/,/s3_sbatch_archive_(.*)/,/s3_(.*)_etag_.*/,/s3_(.*)_archive_.*/,/.*_s3_archive_(.*)/,/s3_etag_(.*)/].reduce(((e,n)=>{if(e)return e;const r=t.find((e=>e.match(n)));return r?r.match(n):null}),null);return n?n[1]:null}(t);n&&(n in P?P[n].push(t):P[n]=[t])})),P}))]).then((function([e,t]){const n=r.d3.select("table#internal-reference"),a=n.append("thead"),s=n.append("tbody"),o=["Log ID","Included","Excluded","Total","Warnings"];a.append("tr").selectAll("th").data(o).enter().append("th").text((function(e){return e})),s.selectAll("tr").data(Object.entries(e)).enter().append("tr").each((function([e,t]){var n=r.d3.select(this).attr("id",`row2-${e}`).classed("hidden",!0);n.append("td").append("div").attr("id",`treemap-${e}`),s.insert("tr",`#row2-${e}`).attr("id",`row-${e}`).append("td").append("a").attr("href","#x").text(e),n.append("td").attr("id",`modal-${e}`).attr("colspan",o.length).text(`Second row for ${e}`)}))}));const V=(new M.Library).DOM},2749:(e,t,n)=>{"use strict";function r(e){return e&&"function"==typeof e.toArrowBuffer}n.r(t),n.d(t,{isArqueroTable:()=>r})},3487:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getArrowTableSchema:()=>o,isArrowTable:()=>s,loadArrow:()=>l});var r=n(4505),a=n(5081);function s(e){return e&&"function"==typeof e.getChild&&"function"==typeof e.toArray&&e.schema&&Array.isArray(e.schema.fields)}function o(e){return e.schema.fields.map(i)}function i(e){return{name:e.name,type:c(e.type),nullable:e.nullable,databaseType:String(e.type)}}function c(e){switch(e.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";default:return"other"}}async function l(){return await n(7585)(`${a.cdn}${r.arrow11.resolve()}`)}},4505:(e,t,n)=>{"use strict";n.r(t),n.d(t,{arquero:()=>_,arrow11:()=>v,arrow4:()=>g,arrow9:()=>w,d3:()=>a,duckdb:()=>$,exceljs:()=>A,graphviz:()=>i,highlight:()=>c,htl:()=>f,inputs:()=>s,jszip:()=>d,katex:()=>l,leaflet:()=>j,lodash:()=>u,marked:()=>p,mermaid:()=>k,plot:()=>o,sql:()=>h,topojson:()=>x,vega:()=>m,vegalite:()=>y,vegaliteApi:()=>b});var r=n(5817);const a=(0,r.dependency)("d3","7.9.0","dist/d3.min.js"),s=(0,r.dependency)("@observablehq/inputs","0.11.0","dist/inputs.min.js"),o=(0,r.dependency)("@observablehq/plot","0.6.16","dist/plot.umd.min.js"),i=(0,r.dependency)("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),c=(0,r.dependency)("@observablehq/highlight.js","2.0.0","highlight.min.js"),l=(0,r.dependency)("@observablehq/katex","0.11.1","dist/katex.min.js"),u=(0,r.dependency)("lodash","4.17.21","lodash.min.js"),f=(0,r.dependency)("htl","0.3.1","dist/htl.min.js"),d=(0,r.dependency)("jszip","3.10.1","dist/jszip.min.js"),p=(0,r.dependency)("marked","0.3.12","marked.min.js"),h=(0,r.dependency)("sql.js","1.8.0","dist/sql-wasm.js"),m=(0,r.dependency)("vega","5.22.1","build/vega.min.js"),y=(0,r.dependency)("vega-lite","5.6.0","build/vega-lite.min.js"),b=(0,r.dependency)("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),g=(0,r.dependency)("apache-arrow","4.0.1","Arrow.es2015.min.js"),w=(0,r.dependency)("apache-arrow","9.0.0","+esm"),v=(0,r.dependency)("apache-arrow","11.0.0","+esm"),_=(0,r.dependency)("arquero","4.8.8","dist/arquero.min.js"),x=(0,r.dependency)("topojson-client","3.1.0","dist/topojson-client.min.js"),A=(0,r.dependency)("exceljs","4.3.0","dist/exceljs.min.js"),k=(0,r.dependency)("mermaid","9.2.2","dist/mermaid.min.js"),j=(0,r.dependency)("leaflet","1.9.3","dist/leaflet.js"),$=(0,r.dependency)("@duckdb/duckdb-wasm","1.24.0","+esm")},5817:(e,t,n)=>{"use strict";function r(e,t,n){return{resolve:(r=n)=>`${e}@${t}/${r}`}}n.r(t),n.d(t,{dependency:()=>r})},6049:(e,t,n)=>{"use strict";function r(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}n.r(t),n.d(t,{canvas:()=>r})},9080:(e,t,n)=>{"use strict";function r(e,t,n){null==n&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var a=r.getContext("2d");return a.scale(n,n),a}n.r(t),n.d(t,{context2d:()=>r})},9501:(e,t,n)=>{"use strict";function r(e,t="untitled",n="Save"){const r=document.createElement("a"),a=r.appendChild(document.createElement("button"));async function s(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),a.textContent=n,a.disabled=!1}return a.textContent=n,r.download=t,r.onclick=async t=>{if(a.disabled=!0,r.href)return s();a.textContent="Saving…";try{const t=await("function"==typeof e?e():e);a.textContent="Download",r.href=URL.createObjectURL(t)}catch(e){a.textContent=n}if(t.eventPhase)return s();a.disabled=!1},r}n.r(t),n.d(t,{download:()=>r})},7949:(e,t,n)=>{"use strict";n.r(t),n.d(t,{element:()=>a});var r={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a(e,t){var n,a=e+="",s=a.indexOf(":");s>=0&&"xmlns"!==(a=e.slice(0,s))&&(e=e.slice(s+1));var o=r.hasOwnProperty(a)?document.createElementNS(r[a],e):document.createElement(e);if(t)for(var i in t)s=(a=i).indexOf(":"),n=t[i],s>=0&&"xmlns"!==(a=i.slice(0,s))&&(i=i.slice(s+1)),r.hasOwnProperty(a)?o.setAttributeNS(r[a],i,n):o.setAttribute(i,n);return o}},9665:(e,t,n)=>{"use strict";n.r(t),n.d(t,{canvas:()=>r.canvas,context2d:()=>a.context2d,download:()=>s.download,element:()=>o.element,input:()=>i.input,range:()=>c.range,select:()=>l.select,svg:()=>u.svg,text:()=>f.text,uid:()=>d.uid});var r=n(6049),a=n(9080),s=n(9501),o=n(7949),i=n(6897),c=n(1916),l=n(5821),u=n(4591),f=n(1738),d=n(1991)},6897:(e,t,n)=>{"use strict";function r(e){var t=document.createElement("input");return null!=e&&(t.type=e),t}n.r(t),n.d(t,{input:()=>r})},1916:(e,t,n)=>{"use strict";function r(e,t,n){1===arguments.length&&(t=e,e=null);var r=document.createElement("input");return r.min=e=null==e?0:+e,r.max=t=null==t?1:+t,r.step=null==n?"any":n=+n,r.type="range",r}n.r(t),n.d(t,{range:()=>r})},5821:(e,t,n)=>{"use strict";function r(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,(function(e){var n=document.createElement("option");n.value=n.textContent=e,t.appendChild(n)})),t}n.r(t),n.d(t,{select:()=>r})},4591:(e,t,n)=>{"use strict";function r(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n}n.r(t),n.d(t,{svg:()=>r})},1738:(e,t,n)=>{"use strict";function r(e){return document.createTextNode(e)}n.r(t),n.d(t,{text:()=>r})},1991:(e,t,n)=>{"use strict";n.r(t),n.d(t,{uid:()=>a});var r=0;function a(e){return new s("O-"+(null==e?"":e+"-")+ ++r)}function s(e){this.id=e,this.href=new URL(`#${e}`,location)+""}s.prototype.toString=function(){return"url("+this.href+")"}},9787:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DuckDBClient:()=>l});var r=n(2749),a=n(3487),s=n(4505),o=n(535),i=n(5081);let c;class l{constructor(e){Object.defineProperties(this,{_db:{value:e}})}async queryStream(e,t){const n=await this._db.connect();let r,s;try{if(t?.length>0){const a=await n.prepare(e);r=await a.send(...t)}else r=await n.send(e);if(s=await r.next(),s.done)throw new Error("missing first batch")}catch(e){throw await n.close(),e}return{schema:(0,a.getArrowTableSchema)(s.value),async*readRows(){try{for(;!s.done;)yield s.value.toArray(),s=await r.next()}finally{await n.close()}}}}async query(e,t){const n=await this.queryStream(e,t),r=[];for await(const e of n.readRows())for(const t of e)r.push(t);return r.schema=n.schema,r}async queryRow(e,t){const n=(await this.queryStream(e,t)).readRows();try{const{done:e,value:t}=await n.next();return e||!t.length?null:t[0]}finally{await n.return()}}async sql(e,...t){return await this.query(e.join("?"),t)}queryTag(e,...t){return[e.join("?"),t]}escape(e){return`"${e}"`}async describeTables(){return(await this.query("SHOW TABLES")).map((({name:e})=>({name:e})))}async describeColumns({table:e}={}){return(await this.query(`DESCRIBE ${this.escape(e)}`)).map((({column_name:e,column_type:t,null:n})=>({name:e,type:p(t),nullable:"NO"!==n,databaseType:t})))}static async of(e={},t={}){const p=await async function(){void 0===c&&(c=async function(){const e=await n(7585)(`${i.cdn}${s.duckdb.resolve()}`),t=await e.selectBundle({mvp:{mainModule:`${i.cdn}${s.duckdb.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${i.cdn}${s.duckdb.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${i.cdn}${s.duckdb.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${i.cdn}${s.duckdb.resolve("dist/duckdb-browser-eh.worker.js")}`}}),r=new e.ConsoleLogger;return{module:e,bundle:t,logger:r}}());const{module:e,bundle:t,logger:r}=await c,a=await e.createWorker(t.mainWorker),o=new e.AsyncDuckDB(r,a);return await o.instantiate(t.mainModule),o}();return void 0===t.query?.castTimestampToDate&&(t={...t,query:{...t.query,castTimestampToDate:!0}}),void 0===t.query?.castBigIntToDouble&&(t={...t,query:{...t.query,castBigIntToDouble:!0}}),await p.open(t),await Promise.all(Object.entries(e).map((async([e,t])=>{if(t instanceof o.FileAttachment)await u(p,e,t);else if((0,a.isArrowTable)(t))await f(p,e,t);else if(Array.isArray(t))await d(p,e,t);else if((0,r.isArqueroTable)(t))await async function(e,t,n){const r=(await(0,a.loadArrow)()).tableFromIPC(n.toArrowBuffer());return await f(e,t,r)}(p,e,t);else if("data"in t){const{data:n,...r}=t;(0,a.isArrowTable)(n)?await f(p,e,n,r):await d(p,e,n,r)}else{if(!("file"in t))throw new Error(`invalid source: ${t}`);{const{file:n,...r}=t;await u(p,e,n,r)}}}))),new l(p)}}async function u(e,t,n,r){const a=await n.url();if(a.startsWith("blob:")){const t=await n.arrayBuffer();await e.registerFileBuffer(n.name,new Uint8Array(t))}else await e.registerFileURL(n.name,new URL(a,location).href,4);const s=await e.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await s.insertCSVFromPath(n.name,{name:t,schema:"main",...r}).catch((async e=>{if(e.toString().includes("Could not convert"))return await async function(e,t,n){const r=await e.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`);return await r.send(t.name)}(s,n,t);throw e}));case"application/json":return await s.insertJSONFromPath(n.name,{name:t,schema:"main",...r});default:if(/\.arrow$/i.test(n.name)){const e=new Uint8Array(await n.arrayBuffer());return await s.insertArrowFromIPCStream(e,{name:t,schema:"main",...r})}if(/\.parquet$/i.test(n.name))return await s.query(`CREATE VIEW '${t}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await s.close()}}async function f(e,t,n,r){const a=await e.connect();try{await a.insertArrowTable(n,{name:t,schema:"main",...r})}finally{await a.close()}}async function d(e,t,n,r){const s=(await(0,a.loadArrow)()).tableFromJSON(n);return await f(e,t,s,r)}function p(e){switch(e){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(e)?"integer":"other"}}Object.defineProperty(l.prototype,"dialect",{value:"duckdb"})},535:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbstractFile:()=>h,FileAttachment:()=>m,FileAttachments:()=>b,NoFileAttachments:()=>y,ZipArchive:()=>g,enforceSchema:()=>d});var r=n(1874),a=n(3287),s=n(9844),o=n(4505),i=n(5081),c=n(4396),l=n(9574),u=n(5515);async function f(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}function d(e,t){const n=new Map(t.map((({name:e,type:t})=>[e,t])));return Object.assign(e.map((e=>(0,l.coerceRow)(e,n,t))),{schema:t})}async function p(e,t,{array:n=!1,typed:o=!1}={}){const i=await e.text(),c="\t"===t?n?r.cP:r.Nu:n?a.fy:a.sw;if("auto"===o&&!n){const e=c(i);return d(e,(0,l.inferSchema)(e,e.columns))}return c(i,o&&s.A)}class h{constructor(e,t){Object.defineProperty(this,"name",{value:e,enumerable:!0}),void 0!==t&&Object.defineProperty(this,"mimeType",{value:t+"",enumerable:!0})}async blob(){return(await f(this)).blob()}async arrayBuffer(){return(await f(this)).arrayBuffer()}async text(){return(await f(this)).text()}async json(){return(await f(this)).json()}async stream(){return(await f(this)).body}async csv(e){return p(this,",",e)}async tsv(e){return p(this,"\t",e)}async image(e){const t=await this.url();return new Promise(((n,r)=>{const a=new Image;new URL(t,document.baseURI).origin!==new URL(location).origin&&(a.crossOrigin="anonymous"),Object.assign(a,e),a.onload=()=>n(a),a.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),a.src=t}))}async arrow({version:e=4}={}){switch(e){case 4:{const[e,t]=await Promise.all([(0,i.requireDefault)(o.arrow4.resolve()),f(this)]);return e.Table.from(t)}case 9:{const[e,t]=await Promise.all([n(7585)(`${i.cdn}${o.arrow9.resolve()}`),f(this)]);return e.tableFromIPC(t)}case 11:{const[e,t]=await Promise.all([n(7585)(`${i.cdn}${o.arrow11.resolve()}`),f(this)]);return e.tableFromIPC(t)}default:throw new Error(`unsupported arrow version: ${e}`)}}async sqlite(){return c.SQLiteDatabaseClient.open(f(this))}async zip(){const[e,t]=await Promise.all([(0,i.requireDefault)(o.jszip.resolve()),this.arrayBuffer()]);return new g(await e.loadAsync(t))}async xml(e="application/xml"){return(new DOMParser).parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[e,t]=await Promise.all([(0,i.requireDefault)(o.exceljs.resolve()),this.arrayBuffer()]);return new u.Workbook(await(new e.Workbook).xlsx.load(t))}}class m extends h{constructor(e,t,n){super(t,n),Object.defineProperty(this,"_url",{value:e})}async url(){return await this._url+""}}function y(e){throw new Error(`File not found: ${e}`)}function b(e){return Object.assign((t=>{const n=e(t+="");if(null==n)throw new Error(`File not found: ${t}`);if("object"==typeof n&&"url"in n){const{url:e,mimeType:r}=n;return new m(e,t,r)}return new m(n,t)}),{prototype:m.prototype})}class g{constructor(e){Object.defineProperty(this,"_",{value:e}),this.filenames=Object.keys(e.files).filter((t=>!e.files[t].dir))}file(e){const t=this._.file(e+="");if(!t||t.dir)throw new Error(`file not found: ${e}`);return new w(t)}}class w extends h{constructor(e){super(e.name),Object.defineProperty(this,"_",{value:e}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}},3110:(e,t,n)=>{"use strict";function r(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)}))}n.r(t),n.d(t,{buffer:()=>r})},1798:(e,t,n)=>{"use strict";n.r(t),n.d(t,{buffer:()=>r.buffer,text:()=>a.text,url:()=>s.url});var r=n(3110),a=n(6575),s=n(6079)},6575:(e,t,n)=>{"use strict";function r(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)}))}n.r(t),n.d(t,{text:()=>r})},6079:(e,t,n)=>{"use strict";function r(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)}))}n.r(t),n.d(t,{url:()=>r})},4899:(e,t,n)=>{"use strict";n.r(t),n.d(t,{disposable:()=>a});var r=n(6997);function a(e,t){let n=!1;if("function"!=typeof t)throw new Error("dispose is not a function");return{[Symbol.iterator]:r.that,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}},2955:(e,t,n)=>{"use strict";function*r(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)}n.r(t),n.d(t,{filter:()=>r})},3945:(e,t,n)=>{"use strict";n.r(t),n.d(t,{disposable:()=>r.disposable,filter:()=>a.filter,input:()=>s.input,map:()=>o.map,observe:()=>i.observe,queue:()=>c.queue,range:()=>l.range,valueAt:()=>u.valueAt,worker:()=>f.worker});var r=n(4899),a=n(2955),s=n(5577),o=n(9291),i=n(8649),c=n(3702),l=n(5492),u=n(5489),f=n(451)},5577:(e,t,n)=>{"use strict";n.r(t),n.d(t,{input:()=>a});var r=n(8649);function a(e){return(0,r.observe)((function(t){var n=function(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}(e),r=s(e);function a(){t(s(e))}return e.addEventListener(n,a),void 0!==r&&t(r),function(){e.removeEventListener(n,a)}}))}function s(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,(e=>e.value));default:return e.value}}},9291:(e,t,n)=>{"use strict";function*r(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)}n.r(t),n.d(t,{map:()=>r})},8649:(e,t,n)=>{"use strict";n.r(t),n.d(t,{observe:()=>a});var r=n(6997);function a(e){let t,n,a=!1;const s=e((function(e){return n?(n(e),n=null):a=!0,t=e}));if(null!=s&&"function"!=typeof s)throw new Error("function"==typeof s.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:r.that,throw:()=>({done:!0}),return:()=>(null!=s&&s(),{done:!0}),next:function(){return{done:!1,value:a?(a=!1,Promise.resolve(t)):new Promise((e=>n=e))}}}}},3702:(e,t,n)=>{"use strict";n.r(t),n.d(t,{queue:()=>a});var r=n(6997);function a(e){let t;const n=[],a=e((function(e){return n.push(e),t&&(t(n.shift()),t=null),e}));if(null!=a&&"function"!=typeof a)throw new Error("function"==typeof a.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:r.that,throw:()=>({done:!0}),return:()=>(null!=a&&a(),{done:!0}),next:function(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise((e=>t=e))}}}}},5492:(e,t,n)=>{"use strict";function*r(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n));++r<a;)yield e+r*n}n.r(t),n.d(t,{range:()=>r})},5489:(e,t,n)=>{"use strict";function r(e,t){if(!(!isFinite(t=+t)||t<0||t!=t|0))for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value}n.r(t),n.d(t,{valueAt:()=>r})},451:(e,t,n)=>{"use strict";n.r(t),n.d(t,{worker:()=>a});var r=n(4899);function a(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return(0,r.disposable)(n,(()=>{n.terminate(),URL.revokeObjectURL(t)}))}},33:(e,t,n)=>{"use strict";n.r(t),n.d(t,{html:()=>r});const r=(0,n(3322).template)((function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)}),(function(){return document.createElement("span")}))},1970:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbstractFile:()=>r.AbstractFile,FileAttachments:()=>r.FileAttachments,Library:()=>a.Library,applyDataTableOperations:()=>i.__table,arrayIsPrimitive:()=>i.arrayIsPrimitive,getArrowTableSchema:()=>s.getArrowTableSchema,getSchema:()=>i.getSchema,getTypeValidator:()=>i.getTypeValidator,inferSchema:()=>i.inferSchema,isArqueroTable:()=>o.isArqueroTable,isArrowTable:()=>s.isArrowTable,isDataArray:()=>i.isDataArray,isDatabaseClient:()=>i.isDatabaseClient,loadDataSource:()=>i.loadDataSource,makeQueryTemplate:()=>i.makeQueryTemplate,observe:()=>c.observe});var r=n(535),a=n(5345),s=n(3487),o=n(2749),i=n(9574),c=n(8649)},6159:(e,t,n)=>{"use strict";n.r(t),n.d(t,{leaflet:()=>a});var r=n(4505);async function a(e){const t=await e(r.leaflet.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(r.leaflet.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}},5345:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Library:()=>j});var r=n(8270),a=n(9665),s=n(1798),o=n(535),i=n(3945),c=n(9787),l=n(33),u=n(6159),f=n(7789),d=n(3329),p=n(6628),h=n(2734),m=n(1065),y=n(7374),b=n(5081),g=n(4396),w=n(6820),v=n(4239),_=n(1949),x=n(70),A=n(4505),k=n(9574);const j=Object.assign(Object.defineProperties((function(e){const t=(0,b.requirer)(e);var n;Object.defineProperties(this,(n={FileAttachment:()=>o.NoFileAttachments,Mutable:()=>p.Mutable,now:h.now,width:x.width,dot:()=>t(A.graphviz.resolve()),htl:()=>t(A.htl.resolve()),html:()=>l.html,md:()=>(0,f.md)(t),svg:()=>w.svg,tex:()=>(0,v.tex)(t),_:()=>t(A.lodash.resolve()),aq:()=>t.alias({"apache-arrow":A.arrow4.resolve()})(A.arquero.resolve()),Arrow:()=>t(A.arrow4.resolve()),d3:()=>t(A.d3.resolve()),DuckDBClient:()=>c.DuckDBClient,Inputs:()=>t(A.inputs.resolve()).then((e=>({...e,file:e.fileOf(o.AbstractFile)}))),L:()=>(0,u.leaflet)(t),mermaid:()=>(0,d.mermaid)(t),Plot:()=>t(A.plot.resolve()),__query:()=>k.__query,require:()=>t,resolve:()=>y.resolve,SQLite:()=>(0,g.SQLite)(t),SQLiteDatabaseClient:()=>g.SQLiteDatabaseClient,topojson:()=>t(A.topojson.resolve()),vl:()=>(0,_.vl)(t),aapl:()=>new o.FileAttachment("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new o.FileAttachment("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new o.FileAttachment("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new o.FileAttachment("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new o.FileAttachment("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new o.FileAttachment("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new o.FileAttachment("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new o.FileAttachment("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new o.FileAttachment("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new o.FileAttachment("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),pizza:()=>new o.FileAttachment("https://static.observableusercontent.com/files/c653108ab176088cacbb338eaf2344c4f5781681702bd6afb55697a3f91b511c6686ff469f3e3a27c75400001a2334dbd39a4499fe46b50a8b3c278b7d2f7fb5").csv({typed:!0}),weather:()=>new o.FileAttachment("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:a,Files:s,Generators:i,Promises:m},Object.fromEntries(Object.entries(n).map($))))}),{resolve:{get:()=>b.requireDefault.resolve,enumerable:!0,configurable:!0},require:{get:()=>b.requireDefault,set:b.setDefaultRequire,enumerable:!0,configurable:!0}}),{resolveFrom:r.dx,requireFrom:r.Ky});function $([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}},7789:(e,t,n)=>{"use strict";n.r(t),n.d(t,{md:()=>s});var r=n(4505),a=n(3322);function s(e){return e(r.marked.resolve()).then((function(t){return(0,a.template)((function(n){var a=document.createElement("div");a.innerHTML=t(n,{langPrefix:""}).trim();var s=a.querySelectorAll("pre code[class]");return s.length>0&&e(r.highlight.resolve()).then((function(t){s.forEach((function(n){function a(){t.highlightBlock(n),n.parentNode.classList.add("observablehq--md-pre")}t.getLanguage(n.className)?a():e(r.highlight.resolve("async-languages/index.js")).then((a=>{if(a.has(n.className))return e(r.highlight.resolve("async-languages/"+a.get(n.className))).then((e=>{t.registerLanguage(n.className,e)}))})).then(a,a)}))})),a}),(function(){return document.createElement("div")}))}))}},3329:(e,t,n)=>{"use strict";n.r(t),n.d(t,{mermaid:()=>s});var r=n(4505),a=n(1991);async function s(e){const t=await e(r.mermaid.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const e=document.createElement("div");return e.innerHTML=t.render((0,a.uid)().id,String.raw.apply(String,arguments)),e.removeChild(e.firstChild)}}},6628:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Mutable:()=>a});var r=n(8649);function a(e){let t;Object.defineProperties(this,{generator:{value:(0,r.observe)((e=>{t=e}))},value:{get:()=>e,set:n=>t(e=n)}}),void 0!==e&&t(e)}},2734:(e,t,n)=>{"use strict";function*r(){for(;;)yield Date.now()}n.r(t),n.d(t,{now:()=>r})},4382:(e,t,n)=>{"use strict";function r(e,t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}n.r(t),n.d(t,{delay:()=>r})},1065:(e,t,n)=>{"use strict";n.r(t),n.d(t,{delay:()=>r.delay,tick:()=>a.tick,when:()=>s.when});var r=n(4382),a=n(9332),s=n(573)},9332:(e,t,n)=>{"use strict";n.r(t),n.d(t,{tick:()=>a});var r=n(573);function a(e,t){return(0,r.when)(Math.ceil((Date.now()+1)/e)*e,t)}},573:(e,t,n)=>{"use strict";n.r(t),n.d(t,{when:()=>a});var r=new Map;function a(e,t){var n;return(n=r.get(e=+e))?n.then((()=>t)):(n=Date.now())>=e?Promise.resolve(t):function(e,t){var n=new Promise((function(n){r.delete(t);var a=t-e;if(!(a>0))throw new Error("invalid time");if(a>2147483647)throw new Error("too long to wait");setTimeout(n,a)}));return r.set(t,n),n}(n,e).then((()=>t))}},5081:(e,t,n)=>{"use strict";n.r(t),n.d(t,{cdn:()=>a,requireDefault:()=>s,requirer:()=>i,setDefaultRequire:()=>o});var r=n(8270);const a="https://cdn.observableusercontent.com/npm/";let s=r.Yp;function o(e){s=e}function i(e){return null==e?s:(0,r.Ky)(e)}},7374:(e,t,n)=>{"use strict";function r(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,null==t?location:t).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}n.r(t),n.d(t,{resolve:()=>r})},4396:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SQLite:()=>s,SQLiteDatabaseClient:()=>o});var r=n(4505),a=n(5081);async function s(e){const[t,n]=await Promise.all([e(r.sql.resolve()),e.resolve(r.sql.resolve("dist/"))]);return t({locateFile:e=>`${n}${e}`})}class o{constructor(e){Object.defineProperties(this,{_db:{value:e}})}static async open(e){const[t,n]=await Promise.all([s(a.requireDefault),Promise.resolve(e).then(c)]);return new o(new t.Database(n))}async query(e,t){return await async function(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:a,values:s}=r,o=s.map((e=>Object.fromEntries(e.map(((e,t)=>[a[t],e])))));return o.columns=a,o}(this._db,e,t)}async queryRow(e,t){return(await this.query(e,t))[0]||null}async explain(e,t){return l("pre",{className:"observablehq--inspect"},[u((await this.query(`EXPLAIN QUERY PLAN ${e}`,t)).map((e=>e.detail)).join("\n"))])}async describeTables({schema:e}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${null==e?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,null==e?[]:[e])}async describeColumns({schema:e,table:t}={}){if(null==t)throw new Error("missing table");const n=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${null==e?"":", ?"}) ORDER BY cid`,null==e?[t]:[t,e]);if(!n.length)throw new Error(`table not found: ${t}`);return n.map((({name:e,type:t,notnull:n})=>({name:e,type:i(t),databaseType:t,nullable:!n})))}async describe(e){const t=await(void 0===e?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[e]));if(!t.length)throw new Error("Not found");const{columns:n}=t;return l("table",{value:t},[l("thead",[l("tr",n.map((e=>l("th",[u(e)]))))]),l("tbody",t.map((e=>l("tr",n.map((t=>l("td",[u(e[t])])))))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(e,...t){return[e.join("?"),t]}}function i(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":case"DATE":case"DATETIME":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function c(e){return"string"==typeof e?fetch(e).then(c):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(c):e instanceof ArrayBuffer?new Uint8Array(e):e}function l(e,t,n){2===arguments.length&&(n=t,t=void 0);const r=document.createElement(e);if(void 0!==t)for(const e in t)r[e]=t[e];if(void 0!==n)for(const e of n)r.appendChild(e);return r}function u(e){return document.createTextNode(e)}Object.defineProperty(o.prototype,"dialect",{value:"sqlite"})},6820:(e,t,n)=>{"use strict";n.r(t),n.d(t,{svg:()=>r});const r=(0,n(3322).template)((function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t}),(function(){return document.createElementNS("http://www.w3.org/2000/svg","g")}))},9574:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__query:()=>w,__table:()=>Z,arrayIsPrimitive:()=>m,coerceRow:()=>X,coerceToType:()=>V,getSchema:()=>Q,getTypeValidator:()=>H,inferSchema:()=>te,isDataArray:()=>f,isDatabaseClient:()=>u,loadDataSource:()=>v,makeQueryTemplate:()=>E});var r=n(3188),a=n(3855),s=n(535),o=n(2749),i=n(3487),c=n(9787);const l=20;function u(e,t){return e&&("function"==typeof e.sql||"function"==typeof e.queryTag&&("function"==typeof e.query||"function"==typeof e.queryStream))&&("table"!==t||"function"==typeof e.describeColumns)&&e!==w}function f(e){return Array.isArray(e)&&(d(e.schema)||p(e.columns)||function(e){const t=Math.min(l,e.length);for(let n=0;n<t;++n){const t=e[n];if(null===t||"object"!=typeof t)return!1}return t>0&&function(e){for(const t in e)return!0;return!1}(e[0])}(e)||y(e)||b(e))||g(e)}function d(e){return Array.isArray(e)&&e.every(h)}function p(e){return Array.isArray(e)&&e.every((e=>"string"==typeof e))}function h(e){return e&&"string"==typeof e.name&&"string"==typeof e.type}function m(e){return g(e)||y(e)||b(e)}function y(e){const t=Math.min(l,e.length);if(!(t>0))return!1;let n,r=!1;for(let a=0;a<t;++a){const t=e[a];if(null==t)continue;const s=typeof t;if(void 0===n)switch(s){case"number":case"boolean":case"string":case"bigint":n=s;break;default:return!1}else if(s!==n)return!1;r=!0}return r}function b(e){const t=Math.min(l,e.length);if(!(t>0))return!1;let n=!1;for(let r=0;r<t;++r){const t=e[r];if(null!=t){if(!(t instanceof Date))return!1;n=!0}}return n}function g(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}const w=Object.assign((async(e,t,n,r)=>{if(u(e=await A(await e,r)))return $(e,E(t,e),n);if(f(e))return Z(e,t);if(!e)throw new Error("missing data source");throw new Error("invalid data source")}),{sql:(e,t,n)=>async function(){return $(await k(await e,n),arguments,t)}});async function v(e,t,n){switch(t){case"chart":return x(e);case"table":return A(e,n);case"sql":return k(e,n)}return e}function _(e){const t=new WeakMap;return(n,r)=>{if(!n||"object"!=typeof n)throw new Error("invalid data source");let a=t.get(n);return(!a||f(n)&&n.length!==a._numRows)&&(a=e(n,r),a._numRows=n.length,t.set(n,a)),a}}const x=_((async e=>{if(e instanceof s.FileAttachment){switch(e.mimeType){case"text/csv":return e.csv({typed:"auto"});case"text/tab-separated-values":return e.tsv({typed:"auto"});case"application/json":return e.json()}throw new Error(`unsupported file type: ${e.mimeType}`)}return e})),A=_((async(e,t)=>{if(e instanceof s.FileAttachment){switch(e.mimeType){case"text/csv":return e.csv();case"text/tab-separated-values":return e.tsv();case"application/json":return e.json();case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return j(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return(0,i.isArrowTable)(e)||(0,o.isArqueroTable)(e)?j(e,t):f(e)&&m(e)?Array.from(e,(e=>({value:e}))):e})),k=_((async(e,t)=>{if(e instanceof s.FileAttachment){switch(e.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return j(e,t);case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return j(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return f(e)?j(await async function(e,t){const n=await(0,i.loadArrow)();return m(e)?n.tableFromArrays({[t]:e}):n.tableFromJSON(e)}(e,t),t):(0,i.isArrowTable)(e)||(0,o.isArqueroTable)(e)?j(e,t):e}));function j(e,t=(e instanceof s.FileAttachment?function(e){return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}(e):"__table")){return c.DuckDBClient.of({[t]:e})}async function $(e,t,n){if(!e)throw new Error("missing data source");if("function"==typeof e.queryTag){const r=new AbortController,a={signal:r.signal};if(n.then((()=>r.abort("invalidated"))),"function"==typeof e.queryStream)return async function*(e){let t=performance.now();const n=await e,r=[];r.done=!1,r.error=null,r.schema=n.schema;try{for await(const e of n.readRows()){performance.now()-t>150&&r.length>0&&(yield r,t=performance.now());for(const t of e)r.push(t)}r.done=!0,yield r}catch(e){r.error=e,yield r}}(e.queryStream(...e.queryTag.apply(e,t),a));if("function"==typeof e.query)return e.query(...e.queryTag.apply(e,t),a)}if("function"==typeof e.sql)return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}function E(e,t){const n="function"==typeof t.escape?t.escape:e=>e,{select:r,from:a,filter:s,sort:o,slice:i}=e;if(!a.table)throw new Error("missing from table");if(r.columns&&0===r.columns.length)throw new Error("at least one column must be selected");const c=new Map(e.names?.map((({column:e,name:t})=>[e,t]))),l=[[`SELECT ${r.columns?r.columns.map((e=>{const t=c.get(e);return t?`${n(e)} AS ${n(t)}`:n(e)})).join(", "):"*"} FROM ${T(a.table,n)}`]];for(let e=0;e<s.length;++e)L(e?"\nAND ":"\nWHERE ",l),F(s[e],l,n);for(let e=0;e<o.length;++e)L(e?", ":"\nORDER BY ",l),O(o[e],l,n);if("mssql"===t.dialect||"oracle"===t.dialect){if(null!==i.to||null!==i.from){if(!o.length){if(!r.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");L("\nORDER BY ",l),O({column:r.columns[0],direction:"ASC"},l,n)}L(`\nOFFSET ${i.from||0} ROWS`,l),L(`\nFETCH NEXT ${null!==i.to?i.to-(i.from||0):1e9} ROWS ONLY`,l)}}else null===i.to&&null===i.from||L("\nLIMIT "+(null!==i.to?i.to-(i.from||0):1e9),l),null!==i.from&&L(` OFFSET ${i.from}`,l);return l}function T(e,t){if("object"==typeof e){let n="";return null!=e.database&&(n+=t(e.database)+"."),null!=e.schema&&(n+=t(e.schema)+"."),n+=t(e.table),n}return t(e)}function L(e,t){const n=t[0];n[n.length-1]+=e}function O({column:e,direction:t},n,r){L(`${r(e)} ${t.toUpperCase()}`,n)}function F({type:e,operands:t},n,r){if(t.length<1)throw new Error("Invalid operand length");if(1===t.length||"v"===e||"nv"===e)switch(q(t[0],n,r),e){case"n":case"nv":return void L(" IS NULL",n);case"nn":case"v":return void L(" IS NOT NULL",n);default:throw new Error("Invalid filter operation")}if(2!==t.length||["in","nin"].includes(e)){var a;switch(q(t[0],n,r),e){case"in":L(" IN (",n);break;case"nin":L(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}!function(e,t){let n=!0;for(const r of e)n?n=!1:L(",",t),t.push(r.value),t[0].push("")}(t.slice(1),n),L(")",n)}else{if(["c","nc"].includes(e)){switch(q(t[0],n,r),e){case"c":L(" LIKE ",n);break;case"nc":L(" NOT LIKE ",n)}return void q((a=t[1],{...a,value:`%${a.value}%`}),n,r)}switch(q(t[0],n,r),e){case"eq":L(" = ",n);break;case"ne":L(" <> ",n);break;case"gt":L(" > ",n);break;case"lt":L(" < ",n);break;case"gte":L(" >= ",n);break;case"lte":L(" <= ",n);break;default:throw new Error("Invalid filter operation")}q(t[1],n,r)}}function q(e,t,n){"column"===e.type?L(n(e.value),t):(t.push(e.value),t[0].push(""))}function C(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))}function D(e,t){return C(e,t)||(e<t?-1:e>t?1:0)}function N(e,t){return C(e,t)||(e>t?-1:e<t?1:0)}const M=e=>"number"==typeof e&&!Number.isNaN(e),R=e=>Number.isInteger(e)&&!Number.isNaN(e),S=e=>"string"==typeof e,I=e=>"boolean"==typeof e,P=e=>"bigint"==typeof e,z=e=>e instanceof Date&&!isNaN(e),B=e=>e instanceof ArrayBuffer,U=e=>Array.isArray(e),G=e=>"object"==typeof e&&null!==e,W=e=>null!=e;function H(e){switch(e){case"string":return S;case"bigint":return P;case"boolean":return I;case"number":return M;case"integer":return R;case"date":return z;case"buffer":return B;case"array":return U;case"object":return G;default:return W}}const K=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function V(e,t){switch(t){case"string":return"string"==typeof e||null==e?e:String(e);case"boolean":if("string"==typeof e){const t=e.trim().toLowerCase();return"true"===t||"false"!==t&&null}return"boolean"==typeof e||null==e?e:Boolean(e);case"bigint":return"bigint"==typeof e||null==e?e:Number.isInteger("string"!=typeof e||e.trim()?+e:NaN)?BigInt(e):void 0;case"integer":case"number":return"number"==typeof e?e:null==e||"string"==typeof e&&!e.trim()?NaN:Number(e);case"date":{if(e instanceof Date||null==e)return e;if("number"==typeof e)return new Date(e);const t=String(e).trim();return"string"!=typeof e||t?new Date(K.test(t)?t:NaN):null}case"array":case"object":case"buffer":case"other":return e;default:throw new Error(`Unable to coerce to type: ${t}`)}}function Q(e){const{columns:t}=e;let{schema:n}=e;return d(n)?{schema:n,inferred:!1}:(n=te(e,p(t)?t:void 0),{schema:n,inferred:!0})}function Y(e,t){const n=e;let{schema:r,inferred:a}=Q(e);const s=new Map(r.map((({name:e,type:t})=>[e,t])));if(t.types){for(const{name:e,type:a}of t.types){s.set(e,a),r===n.schema&&(r=r.slice());const t=r.findIndex((t=>t.name===e));t>-1&&(r[t]={...r[t],type:a})}e=e.map((e=>X(e,s,r)))}else a&&(e=e.map((e=>X(e,s,r))));return{source:e,schema:r}}function J(e,t){if(!t.names)return e;const n=new Map(t.names.map((e=>[e.column,e])));return e.map((e=>Object.fromEntries(Object.keys(e).map((t=>{const r=n.get(t);return[r?.name??t,e[t]]})))))}function Z(e,t){const n=new Map,a=e,s=Y(e,t);e=s.source;let o=s.schema;if(t.derive){const r=[];t.derive.map((({name:a,value:s})=>{let o=[];J(e,t).map(((e,t)=>{let n;try{n=s(e)}catch(e){o.push({index:t,error:e}),n=void 0}r[t]?r[t]={...r[t],[a]:n}:r.push({[a]:n})})),o.length&&n.set(a,o)}));const a=Y(r,t);e=e.map(((e,t)=>({...e,...a.source[t]}))),o=[...o,...a.schema]}for(const{type:n,operands:r}of t.filter){const[{value:t}]=r,a=r.slice(1).map((({value:e})=>e));switch(n){case"v":{const[n]=a,r=H(n);e=e.filter((e=>r(e[t])));break}case"nv":{const[n]=a,r=H(n);e=e.filter((e=>!r(e[t])));break}case"eq":{const[n]=a;if(n instanceof Date){const r=+n;e=e.filter((e=>+e[t]===r))}else e=e.filter((e=>e[t]===n));break}case"ne":{const[n]=a;e=e.filter((e=>e[t]!==n));break}case"c":{const[n]=a;e=e.filter((e=>"string"==typeof e[t]&&e[t].includes(n)));break}case"nc":{const[n]=a;e=e.filter((e=>"string"==typeof e[t]&&!e[t].includes(n)));break}case"in":{const n=new Set(a);e=e.filter((e=>n.has(e[t])));break}case"nin":{const n=new Set(a);e=e.filter((e=>!n.has(e[t])));break}case"n":e=e.filter((e=>null==e[t]));break;case"nn":e=e.filter((e=>null!=e[t]));break;case"lt":{const[n]=a;e=e.filter((e=>e[t]<n));break}case"lte":{const[n]=a;e=e.filter((e=>e[t]<=n));break}case"gt":{const[n]=a;e=e.filter((e=>e[t]>n));break}case"gte":{const[n]=a;e=e.filter((e=>e[t]>=n));break}default:throw new Error(`unknown filter type: ${n}`)}}for(const{column:n,direction:s}of(0,r.A)(t.sort)){const t="desc"===s?N:D;e===a&&(e=e.slice()),e.sort(((e,r)=>t(e[n],r[n])))}let{from:i,to:c}=t.slice;i=null==i?0:Math.max(0,i),c=null==c?1/0:Math.max(0,c),(i>0||c<1/0)&&(e=e.slice(Math.max(0,i),Math.max(0,c)));let l=o.slice();if(t.select.columns){if(o){const e=new Map(o.map((e=>[e.name,e])));o=t.select.columns.map((t=>e.get(t)))}e=e.map((e=>Object.fromEntries(t.select.columns.map((t=>[t,e[t]])))))}if(t.names){const n=new Map(t.names.map((e=>[e.column,e])));o&&(o=o.map((e=>{const t=n.get(e.name);return{...e,...t?{name:t.name}:null}}))),l&&(l=l.map((e=>{const t=n.get(e.name);return{...e,...t?{name:t.name}:null}}))),e=J(e,t)}return e!==a&&o&&(e.schema=o),e.fullSchema=l,e.errors=n,e}function X(e,t,n){const r={};for(const a of n){const n=t.get(a.name),s=e[a.name];r[a.name]="raw"===n?s:V(s,n)}return r}const ee=["boolean","integer","number","date","bigint","array","object","buffer"];function te(e,t=function(e){const t=new Set;for(const n of e)if(n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.add(e);return Array.from(t)}(e)){const n=[],r=e.slice(0,100),s={};for(const e of t){const t=s[e]={boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0};for(const n of r){let r=n[e];if(null==r)continue;const a=typeof r;if("string"!==a)++t.defined,Array.isArray(r)?++t.array:r instanceof Date?++t.date:r instanceof ArrayBuffer?++t.buffer:"number"===a?(++t.number,Number.isInteger(r)&&++t.integer):a in t&&++t[a];else{if(r=r.trim(),!r)continue;++t.defined,++t.string,/^(true|false)$/i.test(r)?++t.boolean:r&&!isNaN(r)?(++t.number,Number.isInteger(+r)&&++t.integer):K.test(r)&&++t.date}}const o=Math.max(1,.9*t.defined),i=(0,a.A)(ee,(e=>t[e]>=o?t[e]:NaN))??(t.string>=o?"string":"other");n.push({name:e,type:i,inferred:i})}return n}},3322:(e,t,n)=>{"use strict";function r(e,t){return function(n){var r,a,s,o,i,c,l,u,f=n[0],d=[],p=null,h=-1;for(i=1,c=arguments.length;i<c;++i){if((r=arguments[i])instanceof Node)d[++h]=r,f+="\x3c!--o:"+h+"--\x3e";else if(Array.isArray(r)){for(l=0,u=r.length;l<u;++l)(a=r[l])instanceof Node?(null===p&&(d[++h]=p=document.createDocumentFragment(),f+="\x3c!--o:"+h+"--\x3e"),p.appendChild(a)):(p=null,f+=a);p=null}else f+=r;f+=n[i]}if(p=e(f),++h>0){for(s=new Array(h),o=document.createTreeWalker(p,NodeFilter.SHOW_COMMENT,null,!1);o.nextNode();)a=o.currentNode,/^o:/.test(a.nodeValue)&&(s[+a.nodeValue.slice(2)]=a);for(i=0;i<h;++i)(a=s[i])&&a.parentNode.replaceChild(d[i],a)}return 1===p.childNodes.length?p.removeChild(p.firstChild):11===p.nodeType?((a=t()).appendChild(p),a):p}}n.r(t),n.d(t,{template:()=>r})},4239:(e,t,n)=>{"use strict";n.r(t),n.d(t,{tex:()=>o});var r=n(4505),a=String.raw;function s(e){return new Promise((function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)}))}function o(e){return Promise.all([e(r.katex.resolve()),e.resolve(r.katex.resolve("dist/katex.min.css")).then(s)]).then((function(e){var t=e[0],n=r();function r(e){return function(){var n=document.createElement("div");return t.render(a.apply(String,arguments),n,e),n.removeChild(n.firstChild)}}return n.options=r,n.block=r({displayMode:!0}),n}))}},6997:(e,t,n)=>{"use strict";function r(){return this}n.r(t),n.d(t,{that:()=>r})},1949:(e,t,n)=>{"use strict";n.r(t),n.d(t,{vl:()=>a});var r=n(4505);async function a(e){const[t,n,a]=await Promise.all([r.vega,r.vegalite,r.vegaliteApi].map((t=>e(t.resolve()))));return a.register(t,n)}},70:(e,t,n)=>{"use strict";n.r(t),n.d(t,{width:()=>a});var r=n(8649);function a(){return(0,r.observe)((function(e){var t=e(document.body.clientWidth);function n(){var n=document.body.clientWidth;n!==t&&e(t=n)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}))}},5515:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Workbook:()=>r});class r{constructor(e){Object.defineProperties(this,{_:{value:e},sheetNames:{value:e.worksheets.map((e=>e.name)),enumerable:!0}})}sheet(e,t){const n="number"==typeof e?this.sheetNames[e]:this.sheetNames.includes(e+="")?e:null;if(null==n)throw new Error(`Sheet not found: ${e}`);return function(e,{range:t,headers:n}={}){let[[r,s],[c,l]]=function(e=":",{columnCount:t,rowCount:n}){if(!(e+="").match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,a=0],[s=t-1,o=n-1]]=e.split(":").map(i);return[[r,a],[s,o]]}(t,e);const u=n?e._rows[s++]:null;let f=new Set(["#"]);for(let e=r;e<=c;e++){const t=u?a(u.findCell(e+1)):null;let n=t&&t+""||o(e);for(;f.has(n);)n+="_";f.add(n)}f=new Array(r).concat(Array.from(f));const d=new Array(l-s+1);for(let t=s;t<=l;t++){const n=d[t-s]=Object.create(null,{"#":{value:t+1}}),o=e.getRow(t+1);if(o.hasValues)for(let e=r;e<=c;e++){const t=a(o.findCell(e+1));null!=t&&(n[f[e+1]]=t)}}return d.columns=f.filter((()=>!0)),d}(this._.getWorksheet(n),t)}}function a(e){if(!e)return;const{value:t}=e;if(t&&"object"==typeof t&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return s(t);if(t.text){let{text:e}=t;return e.richText&&(e=s(e)),t.hyperlink&&t.hyperlink!==e?`${t.hyperlink} ${e}`:e}return t}return t}function s(e){return e.richText.map((e=>e.text)).join("")}function o(e){let t="";e++;do{t=String.fromCharCode(64+(e%26||26))+t}while(e=Math.floor((e-1)/26));return t}function i(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let e=0;e<t.length;e++)r+=Math.pow(26,t.length-e-1)*(t.charCodeAt(e)-64);return[r?r-1:void 0,n?+n-1:void 0]}},8270:(e,t,n)=>{"use strict";n.d(t,{Ky:()=>m,Yp:()=>h,dx:()=>p});const r=new Map,a=[],s=a.map,o=a.some,i=a.hasOwnProperty,c=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,l=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,u=/(?:\.[^/]*|\/)$/;class f extends Error{constructor(e){super(e)}}function d(e){const t=c.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function p(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(t){const n=`${e}${t.name}${t.version?`@${t.version}`:""}/package.json`;let a=r.get(n);return a||r.set(n,a=fetch(n).then((e=>{if(!e.ok)throw new f("unable to load package.json");return e.redirected&&!r.has(e.url)&&r.set(e.url,a),e.json()}))),a}return async function(r,a){if(r.startsWith(e)&&(r=r.substring(e.length)),/^(\w+:)|\/\//i.test(r))return r;if(/^[.]{0,2}\//i.test(r))return new URL(r,null==a?location:a).href;if(!r.length||/^[\s._]/.test(r)||/\s$/.test(r))throw new f("illegal name");const s=d(r);if(!s)return`${e}${r}`;if(!s.version&&null!=a&&a.startsWith(e)){const t=await n(d(a.substring(e.length)));s.version=t.dependencies&&t.dependencies[s.name]||t.peerDependencies&&t.peerDependencies[s.name]}if(s.path&&!u.test(s.path)&&(s.path+=".js"),s.path&&s.version&&l.test(s.version))return`${e}${s.name}@${s.version}/${s.path}`;const o=await n(s);return`${e}${o.name}@${o.version}/${s.path||function(e){for(const n of t){let t=e[n];if("string"==typeof t)return t.startsWith("./")&&(t=t.slice(2)),u.test(t)?t:`${t}.js`}}(o)||"index.js"}`}}f.prototype.name=f.name;var h=m(p());function m(e){const t=new Map,n=o(null);function r(e){if("string"!=typeof e)return e;let n=t.get(e);return n||t.set(e,n=new Promise(((t,n)=>{const r=document.createElement("script");r.onload=()=>{try{t(a.pop()(o(e)))}catch(e){n(new f("invalid module"))}r.remove()},r.onerror=()=>{n(new f("unable to load module")),r.remove()},r.async=!0,r.src=e,window.define=w,document.head.appendChild(r)}))),n}function o(t){return n=>Promise.resolve(e(n,t)).then(r)}function i(e){return arguments.length>1?Promise.all(s.call(arguments,n)).then(y):n(e)}return i.alias=function(t){return m(((n,r)=>n in t&&(r=null,"string"!=typeof(n=t[n]))?n:e(n,r)))},i.resolve=e,i}function y(e){const t={};for(const n of e)for(const e in n)i.call(n,e)&&(null==n[e]?Object.defineProperty(t,e,{get:b(n,e)}):t[e]=n[e]);return t}function b(e,t){return()=>e[t]}function g(e){return"exports"==(e+="")||"module"===e}function w(e,t,n){const r=arguments.length;r<2?(n=e,t=[]):r<3&&(n=t,t="string"==typeof e?[]:e),a.push(o.call(t,g)?e=>{const r={},a={exports:r};return Promise.all(s.call(t,(t=>"exports"==(t+="")?r:"module"===t?a:e(t)))).then((e=>(n.apply(null,e),a.exports)))}:e=>Promise.all(s.call(t,e)).then((e=>"function"==typeof n?n.apply(null,e):n)))}w.amd={}}},e=>{e(e.s=2654)}]);