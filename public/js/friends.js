"use strict";(self.webpackChunkdataviz=self.webpackChunkdataviz||[]).push([[814],{5640:(t,e,a)=>{var n=a(706);const o={top:40,right:40,bottom:40,left:40};let r=[];const s=[],i={year:"numeric",month:"long",day:"numeric"};let l=null;function c(t,e){const a=t.split("").map((t=>t.charCodeAt(0))),n=Uint8Array.from(a);return e&&(console.log("fbString",t),console.log("hex",a.map((t=>`\\u00${t.toString(16)}`)).join("")),console.log("codeArray",a),console.log("byteArray",n)),new TextDecoder("utf-8").decode(n)}globalThis.test=l,n.$.ajax({dataType:"json",contentType:"application/json",url:"/friends.json",error:function(t){console.log("Error",t)},success:function(t){l=t.test;const e=t.friends.map((t=>({timestamp:1e3*t.timestamp,name:c(t.name)})));console.log("data",e);const a=n.d3.scaleLinear().domain(n.d3.extent(e,(t=>t.timestamp))).range([o.left,900-o.right]);r=n.d3.histogram().domain(a.domain()).thresholds(a.ticks(150))(e.map((t=>t.timestamp))),console.log("bins",r),e.forEach((t=>{r.forEach(((e,a)=>{t.timestamp>e.x0&&t.timestamp<e.x1&&(s[a]=s[a]||[],s[a].push(t))}))}));const d=n.d3.scaleLinear().domain([0,Math.max(...s.filter((t=>t)).map((t=>t.length)))]).range([600-o.bottom,o.top]);console.log("buckets",s);const p=n.d3.select("#friends table thead").append("tr");p.append("th"),p.append("th").text("Date"),p.append("th").text("Friends"),p.append("th").text("Count"),p.append("th").text("Notes"),n.d3.select("#friends table tbody").selectAll("tr").data(s).enter().append("tr").attr("id",((t,e)=>`tr-${e}`)).each(((t,e)=>{if(t){const a=n.d3.select(`#tr-${e}`);a.append("td").text(e),a.append("td").classed("dates",!0).text(new Date(r[e].x0).toLocaleDateString("en-GB",i)),a.append("td").text(t.map((t=>t.name)).reverse().join(", ")),a.append("td").text(t.length),a.append("td").append("textarea")}})),new n.t1({margin:o,height:600,width:900,element:"friends_chart",title:"Friends over time",data:e,nav:!1}).scratchpad((function(t){console.log("hello, in scratchpad"),console.log(t.innerWidth),t.svg.append("rect").attr("x",t.margin.left).attr("y",t.margin.top).attr("height",t.innerHeight).attr("width",t.innerWidth).attr("fill","white"),t.svg.append("g").attr("id","columns").attr("transform",`translate(${t.margin.left}, ${t.margin.top})`),globalThis.buckets=s;const e=Math.max(...s.map((t=>t.length)).filter((t=>t)));console.log("Max",e),n.d3.select("#columns").selectAll("rect").data(s).enter().append("rect");const o=n.d3.axisBottom(a).tickFormat((function(t){return new Date(t).toLocaleDateString()})).tickSizeOuter(10);t.svg.append("g").attr("transform",`translate(0,${t.margin.top+t.innerHeight})`).call(o);const r=n.d3.axisLeft(d).tickSizeOuter(10);t.svg.append("g").attr("transform",`translate(${t.margin.left},0)`).call(r)}))}})}},t=>{t(t.s=5640)}]);