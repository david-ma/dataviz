"use strict";(self.webpackChunkdataviz=self.webpackChunkdataviz||[]).push([[463],{1443:(e,t,a)=>{var n=a(706),r=a(7569);const l=(new Date).getFullYear();globalThis.celebrity=function(e,t){r("#birthyear").val(e),r("#deathyear").val(t),d()};let s=null;function d(){n.d3.select("#war_chart svg").remove();const e=parseInt(r("#birthyear").val())||1905,t=parseInt(r("#deathyear").val())||l;e>l?(console.error("You haven't been born yet."),alert("You haven't been born yet.")):t<e&&(console.error("You died before you were born???"),alert("You died before you were born???"));let a=e,d=0;const o={},i={peace:0,war:0};let c=0;s.forEach((function(n,r,s){if(n.end||(n.end=l),n.end>e){const l=JSON.parse(JSON.stringify(n)),h={name:`peace-${r}`,start:a,end:l.start,length:l.start-a};e>n.start&&e<n.end&&(h.length=0,l.length=n.end-e),t<l.end&&(l.end=t,l.length=l.end-l.start,t<l.start&&(l.length=0,h.end=t,h.length=h.end-h.start)),l.length>d&&(d=l.length),a=l.end,i.war+=l.length,c+=l.length,h.length>0&&(o[2*r]=h,i.peace+=h.length,c+=h.length),l.length>0&&(o[2*r+1]=l),r===s.length-1&&t>l.end&&(o[2*r+2]={name:`peace-${r+1}`,start:a,end:t,length:t-a},i.peace+=t-a,c+=t-a)}})),new n.t1({element:"war_chart",data:o,nav:!1}).scratchpad((function(e){const t=e.plot.append("g").attr("transform","translate(370,250)"),a=e.innerHeight/2.5,r=n.d3.pie().sort(null).value((e=>e.length)),l=r(Object.entries(o).reverse()),s=n.d3.arc().innerRadius(.7*a).outerRadius(.8*a),h=n.d3.arc().innerRadius(.9*a).outerRadius(.9*a);t.selectAll("allSlices").data(l).enter().append("path").attr("d",s).attr("fill","black").attr("stroke","white").style("stroke-width","2px").style("opacity",(e=>0===o[e.data[0]].name.indexOf("peace")?.1:e.value/d*.5+.3)),t.selectAll("allPolylines").data(l).enter().append("polyline").style("display",(e=>0===o[e.data[0]].name.indexOf("peace")?"none":"")).attr("stroke","black").style("fill","none").attr("stroke-width",1).attr("points",(function(e){const t=s.centroid(e),n=h.centroid(e),r=h.centroid(e),l=e.startAngle+(e.endAngle-e.startAngle)/2;return r[0]=.95*a*(l<Math.PI?1:-1),[t,n,r]})),t.selectAll("allLabels").data(l).enter().append("text").style("display",(e=>0===o[e.data[0]].name.indexOf("peace")?"none":"")).text((e=>o[e.data[0]].name)).attr("transform",(function(e){const t=h.centroid(e),n=e.startAngle+(e.endAngle-e.startAngle)/2;return t[0]=.99*a*(n<Math.PI?1:-1),"translate("+t+")"})).style("text-anchor",(function(e){return e.startAngle+(e.endAngle-e.startAngle)/2<Math.PI?"start":"end"}));const p=r.value((e=>e[1]))(Object.entries(i).reverse());s.innerRadius(0*a).outerRadius(.65*a),t.selectAll("innerSlices").data(p).enter().append("path").attr("d",s).attr("fill","maroon").attr("stroke","white").style("stroke-width","2px").style("opacity",(e=>e.index%2==1?.1:e.value/d*.5+.3)),e.plot.append("g").attr("transform","translate(220,0)").selectAll(".legendLabel").data(p).enter().append("g").classed("legendLabel",!0).append("rect").attr("x",50).attr("y",((e,t)=>20+30*t)).attr("height",20).attr("width",20).attr("fill","maroon").style("opacity",(e=>e.index%2==1?.1:e.value/d*.5+.3)),n.d3.selectAll(".legendLabel").append("text").attr("x",75).attr("y",((e,t)=>35+30*t)).text((e=>`${e.value} years of ${e.index%2==1?"peace":"war"}: ${n.d3.format(".0%")(e.value/c)}`))}))}n.d3.csv("/blogposts/AmericanWars.csv",(function(e){return e.start=parseInt(e.start),e.end=parseInt(e.end)||"",e.length=(e.end||l)-e.start,e})).then((function(e){s=e,(0,n.ss)(s,{element:"#AmericanWars table",order:[1,"asc"],titles:["War","Start","End"]}),d()})),r("#birthyear, #deathyear").on("keyup",(function(e){13===e.keyCode&&(console.log("hey we've got a keyup?"),d())})),globalThis.drawPieChart=d}},e=>{e(e.s=1443)}]);