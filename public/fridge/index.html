<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Fridge Magnets</title>
  </head>

  <body>
    <div id="page" class="row">
      <div class="week"></div>
      <div class="middle">
        <div class="directions"></div>
        <div id="box"></div>
        <div class="directions"></div>
      </div>
      <div class="week"></div>
    </div>

    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <style>
      body {
        margin: 0;
        font-family: Helvetica, Arial, sans-serif;
      }

      div#page {
        width: 420mm;
        height: 297mm;
        background: lightskyblue;
      }

      div#box {
        float: left;
        width: 340mm;
        height: 217mm;
        background: lightblue;
      }

      div.directions {
        float: left;
        width: 40mm;
        height: 217mm;
        background: lightyellow;
      }

      div.middle {
        float: left;
        width: 420mm;
        height: 217mm;
        background: lightcoral;
        /* background: rgb(255, 166, 0, 0.5); */
      }

      div.week {
        float: left;
        width: 420mm;
        height: 40mm;
        background: lightgreen;
      }

      div.weekday {
        float: left;
        width: 59.11mm;
        height: 40mm;
        background: pink;
        border-right: solid 1mm black;
        text-align: center;
      }
      div.weekday:last-child {
        border-right: none;
      }

      div.magnet {
        width: 24mm;
        height: 24mm;
        float: left;
        border: solid 1px grey;
        padding: 5px;
        text-align: center;
        display: block;
      }

      div.magnet p {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 0.8em;
        text-transform: capitalize;
        position: relative;
        bottom: 4mm;
      }
      img {
        max-width: 2cm;
        max-height: 2cm;
      }
    </style>
    <script>
      d3.json('/fridge_images').then((images) => {
        var box = d3.select('#box').selectAll('div')

        var boxes = box
          .data(images)
          .enter()
          .append('div')
          .classed('magnet', true)

        boxes.each((d, i, all) => {
          var magnet = d3.select(all[i])

          magnet.append('img').attrs((image) => {
            return {
              src: `images/${image}`,
            }
          })
          magnet
            .append('p')
            .html(d.split('.')[0].replace(/\d/, '').replace('_', '&nbsp;'))
        })
      })

      const weekdays = [
        'Monday',
        'Tuesday',
        'Wednesday',
        'Thursday',
        'Friday',
        'Saturday',
        'Sunday',
      ]
      d3.select('.week')
        .selectAll('.weekday')
        .data(weekdays)
        .enter()
        .append('div')
        .classed('weekday', true)
        .append('p')
        .text((d) => d)
    </script>
  </body>
</html>
