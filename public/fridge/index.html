<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Fridge Magnets</title>
  </head>

  <body>
    <div id="page" class="row">
      <div class="week" id="top"></div>
      <div class="middle">
        <div class="directions" id="left">
          <div>
            <h1 style="margin-top: 15mm">Buy more</h1>
            <img class="qr" src="qr.png" />
          </div>
          <div>
            <h1>Fresh</h1>
            <h2>←</h2>
          </div>
          <div style="position: absolute">
            <h1>Eat ASAP</h1>
          </div>
        </div>
        <div id="az_box"></div>
        <div id="ruby_box"></div>
        <div class="directions" id="right">
          <div>
            <h1 style="margin-top: 15mm">Buy more</h1>
            <img class="qr" src="qr.png" />
          </div>
          <div>
            <h1>Fresh</h1>
            <h2>←</h2>
          </div>
          <div style="position: absolute">
            <h1>Eat ASAP</h1>
          </div>
        </div>
      </div>
      <div class="week" id="bottom"></div>
    </div>

    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <style>
      @font-face {
        font-family: 'Gum Chew';
        src: url('/fonts/gum-chew-gum-chew-svg-400.otf') format('truetype');
      }

      body {
        margin: 0;
/*        font-family: Helvetica, Arial, sans-serif;*/
        font-family: 'Gum Chew', cursive;
        text-align: center;
      }

      div#page {
        width: 426mm;
        height: 303mm;
        /* background: lightskyblue; */
      }

      div#az_box,
      div#ruby_box {
        float: left;
        width: 170mm;
        height: 217mm;
        background: black;
      }
      div#az_box {
        background: black;
      }

      div#box {
        float: left;
        width: 340mm;
        height: 217mm;
        background: black;
      }

      div.directions {
/*        display: none; */
        float: left;
        width: 43mm;
        height: 217mm;
        /* background: lightyellow; */
      }
      div.directions h1 {
        font-size: 20px;
        font-weight: 100;
        font-kerning: auto;
      }
      div.directions div {
        width: 43mm;
      }

      div.directions div:nth-child(2) {
        position: absolute;
        top: 100mm;
        border-top: solid 1mm black;
      }

      div.directions div:nth-child(2) h2 {
        rotate: 270deg;
        font-size: 100px;
        margin-top: 50mm;
        margin-right: 16px;
      }

      div.directions div:last-child {
        position: absolute;
        bottom: 43mm;
      }

      div.middle {
        float: left;
        width: 426mm;
        height: 217mm;
        /* background: lightcoral; */
        /* background: rgb(255, 166, 0, 0.5); */
      }

      div.week {
        display: none;
        float: left;
        width: 426mm;
        height: 43mm;
        /* background: lightgreen; */
      }

      div.weekday {
        font-size: 30px;
        float: left;
        width: 60mm;
        height: 43mm;
        /* background: pink; */
        border-right: solid 1mm black;
        text-align: center;
      }
      div.weekday:last-child {
        border-right: none;
      }

      div.magnet {
        width: 21.63mm;
        height: 21.63mm;
        float: left;
        /* border: solid 1mm white; */
        border-radius: 5px;
        padding: 5px;
        display: block;
/*        background-color: #F0F8FF; 
        background-color: #EFF6FA;
        background-color: #FEFEFA; */
        background-color: #FEF3ED;
      }

      #az_box div.magnet {
        background-color: #F0F8FF;
      }

      div.magnet p {
        vertical-align: bottom;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 0.75em;
        text-transform: capitalize;
        position: relative;
        bottom: 4mm;
      }
      img {
        max-width: 18mm;
        max-height: 18mm;
      }
      img.qr {
        display: none;
        max-width: 30mm;
        max-height: 30mm;
      }
    </style>
    <script>
      d3.json('/fridge_images').then((images) => {
        const az_images = images.filter((image) => image.includes('az'))
        const ruby_images = images.filter((image) => image.includes('ruby'))

        var az_box = d3.select('#az_box').selectAll('div')

        var boxes = az_box
          .data(az_images)
          .enter()
          .append('div')
          .classed('magnet', true)

        boxes.each((d, i, all) => {
          var magnet = d3.select(all[i])

          magnet.append('img').attrs((image) => {
            return {
              src: `${image}`,
            }
          })
          magnet
            .append('p')
            .html(d.split('.')[0].split('/')[1].replace(/\d/, '').replace('_', '&nbsp;'))
        })

        
        var ruby_box = d3.select('#ruby_box').selectAll('div')

        var boxes = ruby_box
          .data(ruby_images)
          .enter()
          .append('div')
          .classed('magnet', true)

        boxes.each((d, i, all) => {
          var magnet = d3.select(all[i])

          magnet.append('img').attrs((image) => {
            return {
              src: `${image}`,
            }
          })
          magnet
            .append('p')
            .html(d.split('.')[0].split('/')[1].replace(/\d/, '').replace('_', '&nbsp;'))
        })
      })

      const weekdays = [
        'Monday',
        'Tuesday',
        'Wednesday',
        'Thursday',
        'Friday',
        'Saturday',
        'Sunday',
      ]

      d3.select('#top.week')
        .selectAll('.weekday')
        .data(weekdays)
        .enter()
        .append('div')
        .classed('weekday', true)
        .append('p')
        .text((d) => d)

      d3.select('#bottom.week')
        .selectAll('.weekday')
        .data(weekdays)
        .enter()
        .append('div')
        .classed('weekday', true)
        .append('p')
        .text((d) => d)
    </script>
  </body>
</html>
