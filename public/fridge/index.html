<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Fridge Magnets</title>
  </head>

  <body>
    <div id="page" class="row">
      <div class="week" id="top"></div>
      <div class="middle">
        <div class="directions" id="left">
          <div>
            <h1 style="margin-top: 15mm">Buy more</h1>
            <img class="qr" src="qr.png" />
          </div>
          <div>
            <h1>Fresh</h1>
            <h2>←</h2>
          </div>
          <div style="position: absolute">
            <h1>Eat ASAP</h1>
          </div>
        </div>
        <div id="box"></div>
        <div class="directions" id="right">
          <div>
            <h1 style="margin-top: 15mm">Buy more</h1>
            <img class="qr" src="qr.png" />
          </div>
          <div>
            <h1>Fresh</h1>
            <h2>←</h2>
          </div>
          <div style="position: absolute">
            <h1>Eat ASAP</h1>
          </div>
        </div>
      </div>
      <div class="week" id="bottom"></div>
    </div>

    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <style>
      body {
        margin: 0;
        font-family: Helvetica, Arial, sans-serif;
        text-align: center;
      }

      div#page {
        width: 426mm;
        height: 303mm;
        /* background: lightskyblue; */
      }

      div#box {
        float: left;
        width: 340mm;
        height: 217mm;
        background: black;
      }

      div.directions {
        float: left;
        width: 43mm;
        height: 217mm;
        /* background: lightyellow; */
      }
      div.directions h1 {
        font-size: 24px;
      }
      div.directions div {
        width: 43mm;
      }

      div.directions div:nth-child(2) {
        position: absolute;
        top: 100mm;
        border-top: solid 1mm black;
      }

      div.directions div:nth-child(2) h2 {
        rotate: 270deg;
        font-size: 100px;
        margin-top: 50mm;
        margin-right: 16px;
      }

      div.directions div:last-child {
        position: absolute;
        bottom: 43mm;
      }

      div.middle {
        float: left;
        width: 426mm;
        height: 217mm;
        /* background: lightcoral; */
        /* background: rgb(255, 166, 0, 0.5); */
      }

      div.week {
        float: left;
        width: 426mm;
        height: 43mm;
        /* background: lightgreen; */
      }

      div.weekday {
        font-size: 30px;
        float: left;
        width: 60mm;
        height: 43mm;
        /* background: pink; */
        border-right: solid 1mm black;
        text-align: center;
      }
      div.weekday:last-child {
        border-right: none;
      }

      div.magnet {
        width: 25.689mm;
        height: 25.689mm;
        float: left;
        /* border: solid 1mm white; */
        border-radius: 5px;
        padding: 5px;
        display: block;
        background-color: white;
      }

      div.magnet p {
        vertical-align: bottom;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 0.75em;
        text-transform: capitalize;
        position: relative;
        bottom: 4mm;
      }
      img {
        max-width: 20mm;
        max-height: 20mm;
      }
      img.qr {
        max-width: 30mm;
        max-height: 30mm;
      }
    </style>
    <script>
      d3.json('/fridge_images').then((images) => {
        var box = d3.select('#box').selectAll('div')

        var boxes = box
          .data(images)
          .enter()
          .append('div')
          .classed('magnet', true)

        boxes.each((d, i, all) => {
          var magnet = d3.select(all[i])

          magnet.append('img').attrs((image) => {
            return {
              src: `images/${image}`,
            }
          })
          magnet
            .append('p')
            .html(d.split('.')[0].replace(/\d/, '').replace('_', '&nbsp;'))
        })

        var boxes = box
          .data(images)
          .enter()
          .append('div')
          .classed('magnet', true)

        boxes.each((d, i, all) => {
          var magnet = d3.select(all[i])

          magnet.append('img').attrs((image) => {
            return {
              src: `images/${image}`,
            }
          })
          magnet
            .append('p')
            .html(d.split('.')[0].replace(/\d/, '').replace('_', '&nbsp;'))
        })

        d3.select('#box')
          .append('div')
          .classed('magnet', true)
          .style('width', '337.3mm')
          .style('height', '16.5mm')
      })

      const weekdays = [
        'Monday',
        'Tuesday',
        'Wednesday',
        'Thursday',
        'Friday',
        'Saturday',
        'Sunday',
      ]

      d3.select('#top.week')
        .selectAll('.weekday')
        .data(weekdays)
        .enter()
        .append('div')
        .classed('weekday', true)
        .append('p')
        .text((d) => d)

      d3.select('#bottom.week')
        .selectAll('.weekday')
        .data(weekdays)
        .enter()
        .append('div')
        .classed('weekday', true)
        .append('p')
        .text((d) => d)
    </script>
  </body>
</html>
